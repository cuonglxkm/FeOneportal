<ng-container *ngIf="detailCluster; else loadingTpl">
  <ng-container *ngIf="!isEditMode; else submitModeTpl">
    <button nz-button nzType="default" (click)="onEditCluster()" class="mb-3">
      <span nz-icon nzType="edit" nzTheme="outline"></span>
      Điều chỉnh
    </button>
  </ng-container>
  <ng-template #submitModeTpl>
    <button nz-button nzType="primary" (click)="onConfirmUpgradeService()" class="mb-3"
      [disabled]="isUpgrading || upgradeForm.invalid">
      <span nz-icon nzType="check" nzTheme="outline"></span>
      Xác nhận
    </button>
    <button nz-button nzType="primary" nzDanger (click)="onCancelEdit()" class="mb-3" [disabled]="isUpgrading">
      <span nz-icon nzType="close" nzTheme="outline"></span>
      Hủy bỏ
    </button>
  </ng-template>

  <form nz-form [formGroup]="upgradeForm">
    <!-- Thông tin chung -->
    <nz-card class="border-card">
      <h3>Thông tin chung</h3>
      <div nz-row>
        <div nz-col [nzSpan]="24" class="detailtable">
          <nz-table [nzTemplateMode]="true" nzBordered>
            <tbody>
              <tr>
                <td class="w-50" [ngClass]="{'padbot-zero': isEditMode == true}">
                  <div nz-row>
                    <div nz-col [nzSpan]="8" [ngClass]="{'padtop-5': isEditMode == true}">Tên cluster</div>
                    <div nz-col [nzSpan]="16" class="description-info">
                      <ng-container *ngIf="!isEditMode; else editClusterNameTpl">
                        {{detailCluster.clusterName}}
                      </ng-container>
                      <ng-template #editClusterNameTpl>
                        <nz-form-item>
                          <nz-form-control [nzErrorTip]="errorClusterNameTpl">
                            <input type="text" nz-input formControlName="clusterName" placeholder="Nhập tên cluster" />
                          </nz-form-control>
                          <ng-template #errorClusterNameTpl>
                            <ng-container *ngIf="control.hasError('required')">
                              <div>Tên cluster không để trống</div>
                            </ng-container>
                            <ng-container *ngIf="control.hasError('minlength') || control.hasError('maxlength')">
                              <div>Tên cluster trong khoảng từ 5-50 ký tự</div>
                            </ng-container>
                            <ng-container *ngIf="control.hasError('pattern')">
                              <div>Tên cluster chỉ bao gồm các chữ thường, chữ hoa, số và các ký tự _-</div>
                            </ng-container>
                          </ng-template>
                        </nz-form-item>
                      </ng-template>
                    </div>
                  </div>
                </td>
                <td class="w-50">
                  <div nz-row>
                    <div nz-col [nzSpan]="8">
                      Phiên bản Kubernetes
                    </div>
                    <div nz-col [nzSpan]="16" class="description-info">
                      {{detailCluster.currentVersion}}
                      <button nz-button nzType="text" (click)="handleShowModalUpgradeVersion()"
                        class="action-icon borderless" nzTooltipTitle="Nâng cấp" nzTooltipPlacement="top" nz-tooltip>
                        <span nz-icon>
                          <svg viewBox="64 64 896 896" focusable="false">
                            <path
                              d="M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z" />
                          </svg>
                        </span>
                      </button>
                    </div>
                  </div>
                </td>
              </tr>

              <tr>
                <!-- <td class="w-50"><row-data [value]="detailCluster.apiEndpoint" [label]="'API Endpoint'"></row-data></td> -->
                <td class="w-50">
                  <div nz-row>
                    <div nz-col [nzSpan]="8">
                      API Endpoint
                    </div>
                    <div nz-col [nzSpan]="16" class="description-info">
                      <ng-container *ngIf="detailCluster.apiEndpoint?.length <= 30; else truncateEndpointTpl">
                        {{detailCluster.apiEndpoint}}
                      </ng-container>
                      <ng-template #truncateEndpointTpl>
                        <span nz-popover nzPopoverTitle="API Endpoint" [nzPopoverContent]="apiEnpointTpl"
                          nzPopoverPlacement="bottom">
                          {{detailCluster.apiEndpoint | truncateLabel}}
                        </span>

                        <ng-template #apiEnpointTpl>
                          <div style="width: fit-content">{{detailCluster.apiEndpoint}}</div>
                        </ng-template>
                      </ng-template>

                      <button nz-button nzType="text" (click)="handleCopyAPIEndpoint()" class="action-icon borderless"
                        nzTooltipTitle="Sao chép" nzTooltipPlacement="top" nz-tooltip>
                        <span nz-icon nzType="copy" nzTheme="outline"></span>
                      </button>
                    </div>
                  </div>
                </td>
                <td class="w-50"><row-data [value]="detailCluster.orderCode" [label]="'Mã đơn hàng'"></row-data></td>
              </tr>

              <tr>
                <td class="w-50"><row-data [value]="detailCluster.createdDate | date: 'dd/MM/yyyy'"
                    [label]="'Ngày khởi tạo'"></row-data></td>
                <td class="w-50"><row-data
                    [value]="(detailCluster.createdDate | calculateDate : detailCluster.usageTime) | date: 'dd/MM/yyyy'"
                    [label]="'Ngày hết hạn'" [type]="'danger'"></row-data></td>
              </tr>

              <tr>
                <td class="w-50">
                  <div nz-row>
                    <div nz-col [nzSpan]="8">Trạng thái</div>
                    <div nz-col [nzSpan]="16">
                      <ng-container *ngIf="detailCluster.serviceStatus | status2ColorPipe as status">
                        <span [ngStyle]="{color: status.color, 'font-weight': 600}">{{status.status}}</span>
                      </ng-container>
                    </div>
                  </div>
                </td>
                <td class="w-50"><row-data [value]="detailCluster.description" [label]="'Mô tả'"></row-data></td>
              </tr>

              <tr>
                <td class="w-50">
                  <div nz-row>
                    <div nz-col [nzSpan]="8">Cấu hình</div>
                    <div nz-col [nzSpan]="16">
                      <span class="description-info">
                        <a (click)="handleViewKubeConfig()">{{detailCluster.clusterName}}.Kubeconfig</a>
                      </span>
                      <button nz-button nzType="text" (click)="handleDownloadKubeConfig()"
                        class="action-icon borderless" nzTooltipTitle="Tải file cấu hình" nzTooltipPlacement="top"
                        nz-tooltip>
                        <span nz-icon class="primary-color">
                          <svg viewBox="64 64 896 896" focusable="false">
                            <path
                              d="M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z" />
                          </svg>
                        </span>
                      </button>
                      <button nz-button nzType="text" (click)="handleSyncClusterInfo()" class="action-icon borderless"
                        nzTooltipTitle="Sao chép" nzTooltipPlacement="top" nz-tooltip (click)="handleCopyKubeConfig()">
                        <span nz-icon nzType="copy" nzTheme="outline"></span>
                      </button>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </nz-table>
        </div>
      </div>
    </nz-card>

    <!-- Thông tin worker group -->
    <nz-card class="border-card">
      <h3>Thông tin worker group</h3>
      <div formArrayName="workerGroup" *ngFor="let control of listFormWorkerGroupUpgrade.controls; let i = index;">
        <ng-container [formGroupName]="i">
          <div nz-row>
            <div nz-col [nzSpan]="24" class="detailtable">
              <nz-table [nzTemplateMode]="true" nzBordered>
                <tbody>
                  <tr>
                    <td class="w-50" [ngClass]="{'padbot-zero': isEditMode == true}">
                      <div nz-row>
                        <div nz-col [nzSpan]="8" [ngClass]="{'padtop-5': isEditMode == true}">Tên nhóm worker</div>
                        <div nz-col [nzSpan]="16" class="description-info">
                          <ng-container *ngIf="!isEditMode; else editWorkerGroupNameTpl">
                            {{'workerGroupName' | getValueInForm: listFormWorkerGroupUpgrade : i}}
                          </ng-container>
                          <ng-template #editWorkerGroupNameTpl>
                            <nz-form-item>
                              <nz-form-control [nzErrorTip]="errorWorkerNameTpl">
                                <input nz-input type="text" formControlName="workerGroupName"
                                  placeholder="Nhập tên nhóm worker" />
                              </nz-form-control>
                              <ng-template #errorWorkerNameTpl let-control>
                                <ng-container *ngIf="control.hasError('required')">
                                  Tên nhóm worker không để trống
                                </ng-container>
                                <ng-container *ngIf="control.hasError('duplicateName')">
                                  Tên nhóm worker đã tồn tại
                                </ng-container>
                                <ng-container *ngIf="control.hasError('maxlength')">
                                  Tên nhóm worker tối đa 16 ký tự
                                </ng-container>
                                <ng-container *ngIf="control.hasError('pattern')">
                                  Tên nhóm worker chỉ chứa các ký tự và số viết thường hoặc dấu gạch nối
                                </ng-container>
                              </ng-template>
                            </nz-form-item>
                          </ng-template>
                        </div>
                      </div>
                    </td>

                    <td class="w-50" [ngClass]="{'padbot-zero': isEditMode == true}">
                      <div nz-row>
                        <div nz-col [nzSpan]="8" [ngClass]="{'padtop-5': isEditMode == true}">Số node</div>
                        <div nz-col [nzSpan]="16" class="description-info">
                          <ng-container *ngIf="!isEditMode; else editNodeNumberTpl">
                            {{'nodeNumber' | getValueInForm: listFormWorkerGroupUpgrade : i}}
                          </ng-container>
                          <ng-template #editNodeNumberTpl>
                            <nz-form-item>
                              <nz-form-control [nzErrorTip]="errorNodeNumberTpl">
                                <input nz-input type="text" formControlName="nodeNumber" (keypress)="isNumber($event)"
                                  (ngModeChange)="onChangeNodeNumber($event, i)" />
                              </nz-form-control>
                              <ng-template #errorNodeNumberTpl>
                                <ng-container *ngIf="control.hasError('required')">
                                  Số node không để trống
                                </ng-container>
                                <ng-container *ngIf="control.hasError('min') || control.hasError('max')">
                                  Số node trong khoảng từ 1-10
                                </ng-container>
                              </ng-template>
                            </nz-form-item>
                          </ng-template>
                        </div>
                      </div>
                    </td>
                  </tr>

                  <tr>
                    <td class="w-50" [ngClass]="{'padbot-zero': isEditMode == true}">
                      <div nz-row>
                        <div nz-col [nzSpan]="8" [ngClass]="{'padtop-5': isEditMode == true}">Cấu hình</div>
                        <div nz-col [nzSpan]="16" class="description-info">
                          <ng-container *ngIf="!isEditMode; else editConfigTypeTpl">
                            {{'cpu' | getValueInForm: listFormWorkerGroupUpgrade : i}}vCPU / {{'ram' | getValueInForm:
                            listFormWorkerGroupUpgrade : i}}GB
                          </ng-container>
                          <ng-template #editConfigTypeTpl>
                            <nz-form-item>
                              <nz-form-control [nzErrorTip]="errorConfigError">
                                <nz-select formControlName="configType" nzShowSearch nzPlaceHolder="Chọn cấu hình"
                                  (ngModelChange)="onChangeConfigType($event, i)" class="w-100">
                                  <nz-option *ngFor="let item of listOfWorkerType"
                                    nzLabel="{{item.machineName}} ({{item.cpu}} CPU - {{item.ram}} GB RAM)"
                                    [nzValue]="item.machineName">
                                  </nz-option>
                                </nz-select>
                              </nz-form-control>
                            </nz-form-item>
                          </ng-template>
                        </div>
                      </div>
                    </td>

                    <td class="w-50" [ngClass]="{'padbot-zero': isEditMode == true}">
                      <div nz-row>
                        <div nz-col [nzSpan]="8" [ngClass]="{'padtop-5': isEditMode == true}">Ổ cứng (GB)</div>
                        <div nz-col [nzSpan]="16" class="description-info">
                          <ng-container *ngIf="!isEditMode; else editWorkerVolumeSizeTpl">
                            {{'volumeStorage' | getValueInForm: listFormWorkerGroupUpgrade : i}}
                          </ng-container>
                          <ng-template #editWorkerVolumeSizeTpl>
                            <nz-form-item>
                              <nz-form-control [nzErrorTip]="volumeErrorTpl">
                                <input nz-input type="text" formControlName="volumeStorage"
                                  (keypress)="isNumber($event)" (ngModelChange)="onChangeVolumeWorker($event, i)" />
                              </nz-form-control>
                              <ng-template #volumeErrorTpl let-control>
                                <ng-container *ngIf="control.hasError('required')">
                                  Ổ cứng không để trống
                                </ng-container>
                                <ng-container *ngIf="control.hasError('min') || control.hasError('max')">
                                  Ổ cứng trong khoảng từ 20-1000 GB
                                </ng-container>
                                <ng-container *ngIf="control.hasError('invalid')">
                                  Ổ cứng không nhỏ hơn số đang sử dụng
                                </ng-container>
                              </ng-template>
                            </nz-form-item>
                          </ng-template>
                        </div>
                      </div>
                    </td>
                  </tr>

                  <tr>
                    <td class="w-50">
                      <div nz-row>
                        <div nz-col [nzSpan]="8">Auto scale</div>
                        <div nz-col [nzSpan]="16" class="description-info">
                          <ng-container *ngIf="!isEditMode; else editScalingTpl">
                            <ng-container
                              *ngIf="('autoScalingWorker' | getValueInForm: listFormWorkerGroupUpgrade : i) == true; else offAutoScaleTpl">
                              Bật
                            </ng-container>
                            <ng-template #offAutoScaleTpl>
                              Tắt
                            </ng-template>
                          </ng-container>
                          <ng-template #editScalingTpl>
                            <nz-switch formControlName="autoScalingWorker" (ngModelChange)="onChangeAutoScale($event)"
                              nzCheckedChildren="Bật" nzUnCheckedChildren="Tắt"></nz-switch>
                          </ng-template>
                        </div>
                      </div>
                    </td>

                    <td class="w-50">
                      <div nz-row>
                        <div nz-col [nzSpan]="8">Auto healing</div>
                        <div nz-col [nzSpan]="16" class="description-info">
                          <ng-container *ngIf="!isEditMode; else editHealingTpl">
                            <ng-container
                              *ngIf="('autoHealing' | getValueInForm: listFormWorkerGroupUpgrade : i) == true; else offAutoHealingTpl">
                              Bật
                            </ng-container>
                            <ng-template #offAutoHealingTpl>
                              Tắt
                            </ng-template>
                          </ng-container>
                          <ng-template #editHealingTpl>
                            <nz-switch formControlName="autoHealing" nzCheckedChildren="Bật"
                              nzUnCheckedChildren="Tắt"></nz-switch>
                          </ng-template>
                        </div>
                      </div>
                    </td>
                  </tr>

                  <ng-container *ngIf="isAutoScale">
                    <tr>
                      <td class="w-50" [ngClass]="{'padbot-zero': isEditMode == true}">
                        <div nz-row>
                          <div nz-col [nzSpan]="8" [ngClass]="{'padtop-5': isEditMode == true}">Minimum node</div>
                          <div nz-col [nzSpan]="16" class="description-info">
                            <ng-container *ngIf="!isEditMode; else editMinimumNodeTpl">
                              {{'minimumNode' | getValueInForm: listFormWorkerGroupUpgrade : i}}
                            </ng-container>
                            <ng-template #editMinimumNodeTpl>
                              <nz-form-item>
                                <nz-form-control [nzErrorTip]="errorMinimumNodeTpl">
                                  <input nz-input type="text" formControlName="minimumNode"
                                    placeholder="Nhập số node tối thiểu" />
                                </nz-form-control>
                                <ng-template #errorMinimumNodeTpl>
                                  <ng-container *ngIf="control.hasError('required')">
                                    Số node tối thiểu không để trống
                                  </ng-container>
                                  <ng-container *ngIf="control.hasError('invalid')">
                                    Số node tối thiểu không lớn hơn số node tối đa
                                  </ng-container>
                                  <ng-container *ngIf="control.hasError('min') || control.hasError('max')">
                                    Số node tối thiểu trong khoảng 1-10
                                  </ng-container>
                                </ng-template>
                              </nz-form-item>
                            </ng-template>
                          </div>
                        </div>
                      </td>

                      <td class="w-50" [ngClass]="{'padbot-zero': isEditMode == true}">
                        <div nz-row>
                          <div nz-col [nzSpan]="8" [ngClass]="{'padtop-5': isEditMode == true}">Maximum node</div>
                          <div nz-col [nzSpan]="16" class="description-info">
                            <ng-container *ngIf="!isEditMode; else editMaximumNodeTpl">
                              {{'maximumNode' | getValueInForm: listFormWorkerGroupUpgrade : i}}
                            </ng-container>
                            <ng-template #editMaximumNodeTpl>
                              <nz-form-item>
                                <nz-form-control [nzErrorTip]="errorMaximumNodeTpl">
                                  <input nz-input type="text" formControlName="maximumNode"
                                    placeholder="Nhập số node tối đa" />
                                </nz-form-control>
                                <ng-template #errorMaximumNodeTpl>
                                  <ng-container *ngIf="control.hasError('required')">
                                    Số node tối đa không để trống
                                  </ng-container>
                                  <ng-container *ngIf="control.hasError('min') || control.hasError('max')">
                                    Số node tối đa trong khoảng từ 1-10
                                  </ng-container>
                                </ng-template>
                              </nz-form-item>
                            </ng-template>
                          </div>
                        </div>
                      </td>
                    </tr>
                  </ng-container>
                </tbody>
              </nz-table>
            </div>

            <ng-container *ngIf="isEditMode">
              <nz-divider nzDashed></nz-divider>
            </ng-container>
          </div>
        </ng-container>
      </div>

      <ng-container *ngIf="isEditMode">
        <button nz-button nzType="default" class="border-button" (click)="addWorkerGroup()">
          <span nz-icon>
            <svg viewBox="64 64 896 896" focusable="false">
              <path d="M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z" />
              <path d="M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z" />
            </svg>
          </span>
          Thêm worker group
        </button>
      </ng-container>
    </nz-card>

    <!-- Thông tin network -->
    <nz-card class="border-card">
      <h3>Thông tin network</h3>
      <div nz-row>
        <div nz-col [nzSpan]="24" class="detailtable">
          <nz-table [nzTemplateMode]="true" nzBordered>
            <tbody>
              <tr>
                <td class="w-50"><row-data [value]="detailCluster.networkType | network2label"
                    [label]="'Loại network'"></row-data></td>
                <td class="w-50"><row-data [value]="detailCluster.cidr" [label]="'Pod CIDR'"></row-data></td>
              </tr>

              <tr>
                <td class="w-50"><row-data [value]="vpcNetwork" [label]="'Mạng VPC'"></row-data></td>
                <td class="w-50"><row-data [value]="detailCluster.subnet" [label]="'Subnet'"></row-data></td>
              </tr>
            </tbody>
          </nz-table>
        </div>
      </div>
    </nz-card>

    <!-- Thông tin volume -->
    <nz-card class="border-card">
      <h3>Thông tin volume persistent</h3>
      <div nz-row>
        <div nz-col [nzSpan]="24" class="detailtable">
          <nz-table [nzTemplateMode]="true" nzBordered>
            <tbody>
              <tr>
                <td class="w-50" [ngClass]="{'padbot-zero': isEditMode == true}">
                  <div nz-row>
                    <div nz-col [nzSpan]="8" [ngClass]="{'padtop-5': isEditMode == true}">Loại</div>
                    <div nz-col [nzSpan]="16" class="description-info">
                      <ng-container *ngIf="!isEditMode; else editVolumeTypeTpl">
                        {{detailCluster.volumeCloudType == 'hdd' ? 'HDD' : 'SSD'}}
                      </ng-container>
                      <ng-template #editVolumeTypeTpl>
                        <nz-form-item>
                          <nz-form-control>
                            <nz-radio-group formControlName="volumeCloudType">
                              <label nz-radio nzValue="hdd">HDD</label>
                              <label nz-radio nzValue="sdd">SDD</label>
                            </nz-radio-group>
                          </nz-form-control>
                        </nz-form-item>
                      </ng-template>
                    </div>
                  </div>
                </td>

                <td class="w-50" [ngClass]="{'padbot-zero': isEditMode == true}">
                  <div nz-row>
                    <div nz-col [nzSpan]="8" [ngClass]="{'padtop-5': isEditMode == true}">Quota (GB)</div>
                    <div nz-col [nzSpan]="16" class="description-info">
                      <ng-container *ngIf="!isEditMode; else editVolumeSizeTpl">
                        {{detailCluster.volumeCloudSize}}
                      </ng-container>
                      <ng-template #editVolumeSizeTpl>
                        <nz-form-item>
                          <nz-form-control [nzErrorTip]="errorVolumeSizeTpl">
                            <input type="text" nz-input formControlName="volumeCloudSize" (keypress)="isNumber($event)"
                              (ngModelChange)="onChangeVolumeSize($event)" />
                          </nz-form-control>
                          <ng-template #errorVolumeSizeTpl let-control>
                            <ng-container *ngIf="control.hasError('required')">
                              Quota volume không để trống
                            </ng-container>
                            <ng-container *ngIf="control.hasError('max') || control.hasError('min')">
                              Quota trong khoảng từ 20-1000 (GB)
                            </ng-container>
                          </ng-template>
                        </nz-form-item>
                      </ng-template>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </nz-table>
        </div>
      </div>
    </nz-card>
  </form>

</ng-container>

<ng-template #loadingTpl>
  loading ...
</ng-template>

<!-- modal upgrade -->
<nz-modal [(nzVisible)]="showModalUpgradeVersion" nzTitle="Nâng cấp phiên bản"
  (nzOnCancel)="handleCancelShowModalUpgrade()">
  <div *nzModalContent>
    <ng-container *ngIf="detailCluster.upgradeVersion?.length > 0; else noAvailableVersionTpl">
      <p class="description-info">Lưu ý: Chỉ có thể nâng cấp phiên bản, không thực hiện việc hạ phiên bản.</p>
      <p>Để tránh phát sinh vấn đề trong quá trình xử lý, chỉ nâng cấp phiên bản lần lượt theo thứ tự.</p>
      <div>
        <nz-select nzPlaceHolder="Chọn phiên bản nâng cấp" [(ngModel)]="upgradeVersionCluster" class="w-100">
          <nz-option *ngFor="let item of listOfK8sVersion" [nzLabel]="item.k8sVersion" [nzValue]="item.k8sVersion"
            [nzDisabled]="item.k8sVersion | checkUpgradeVersion : detailCluster.upgradeVersion"></nz-option>
        </nz-select>
      </div>
    </ng-container>
    <ng-template #noAvailableVersionTpl>
      Bạn đang sử dụng phiên bản <b>{{detailCluster.currentVersion}}</b> mới nhất
    </ng-template>
  </div>
  <div *nzModalFooter>
    <ng-container *ngIf="detailCluster.upgradeVersion?.length > 0; else noAvailableVersionFooterTpl">
      <button nz-button nzType="default" (click)="handleCancelShowModalUpgrade()">Hủy bỏ</button>
      <button nz-button nzType="primary" (click)="handleUpgadeVersionCluster()" [nzLoading]="isUpgradingVersion"
        [disabled]="upgradeVersionCluster == null || upgradeVersionCluster == undefined">Xác nhận</button>
    </ng-container>
    <ng-template #noAvailableVersionFooterTpl>
      <button nz-button nzType="default" (click)="handleCancelShowModalUpgrade()">Đóng</button>
    </ng-template>
  </div>
</nz-modal>

<!-- modal view kubeconfig -->
<nz-modal [(nzVisible)]="showModalKubeConfig" [nzTitle]="viewKubeConfigTitle" [nzContent]="viewKubeConfigBodyTpl"
  [nzFooter]="viewKubeConfigFooterTpl" (nzOnCancel)="handleCancelModalViewKubeConfig()">
  <ng-template #viewKubeConfigTitle>
    <div>
      <label>Cluster {{detailCluster.clusterName}} Kubenetes Config</label>
      <div class="modal-btn">
        <button nz-button nzType="text" class="borderless" (click)="handleCopyKubeConfig()" style="height: fit-content;"
          nzTooltipTitle="Sao chép" nzTooltipPlacement="top" nz-tooltip>
          <span nz-icon nzType="copy" nzTheme="outline" class="primary-color"></span>
        </button>
        <button nz-button nzType="text" class="borderless" (click)="handleDownloadKubeConfig()"
          style="height: fit-content;" nzTooltipTitle="Tải file cấu hình" nzTooltipPlacement="top" nz-tooltip>
          <span nz-icon class="primary-color">
            <svg viewBox="64 64 896 896" focusable="false">
              <path
                d="M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z" />
            </svg>
          </span>
        </button>
      </div>
    </div>
  </ng-template>

  <ng-template #viewKubeConfigBodyTpl>
    <div class="modal-view">
      <pre>{{yamlString}}</pre>
    </div>
  </ng-template>

  <ng-template #viewKubeConfigFooterTpl>
    <button nz-button nzType="primary" (click)="handleCancelModalViewKubeConfig()">
      <span nz-icon nzType="check" nzTheme="outline"></span>
      Đóng
    </button>
  </ng-template>
</nz-modal>
