<ng-container *ngIf="itemDetail">
    <page-header [breadcrumb]="breadcrumb" [title]="'Nâng cấp dịch vụ Kafka'">
        <ng-template #breadcrumb>
            <nz-breadcrumb>
                <nz-breadcrumb-item>
                    <a [routerLink]="['/']">Trang chủ</a>
                </nz-breadcrumb-item>
                <nz-breadcrumb-item>
                    <a [routerLink]="['/app-kafka']">Kafka</a>
                </nz-breadcrumb-item>
                <nz-breadcrumb-item>
                    Nâng cấp dịch vụ Kafka
                </nz-breadcrumb-item>
            </nz-breadcrumb>
        </ng-template>
    </page-header>

    <div nz-row [nzGutter]="16">
        <div nz-col [nzSpan]="16" class="form-new">
            <form nz-form [formGroup]="myform" nzLayout="horizontal" nzLabelAlign="left">

                <nz-card class="border-card">
                    <h3><b>Các gói dịch vụ</b></h3>
                    <span nzType="secondary" style="color: #6C757D;">
                        Khi nâng cấp gói dịch vụ, khách hàng chỉ có thể chọn gói có cấu hình lớn hơn hoặc tăng mức cấu hình của CPU, RAM và Storage lớn hơn mức của gói đang dùng.  
                    </span>
                    <nz-tabset nzCentered style="margin-top: 15px;">
                        <nz-tab nzTitle="Gói cấu hình sẵn" (nzClick)="clicktab()">
                            <ng-template nz-tab>
                                <ngu-carousel #myCarousel [inputs]="carouselConfig" [dataSource]="listOfServicePack"
                                    class="carousel-div">
                                    <div *nguCarouselDef="let item;" class="item">
                                        <div class="pack-item" [ngClass]="{ 'choose': item===chooseitem, 'pack-item-disable': item.storage < storage }"
                                            (click)="handleChoosePack(item)">
                                            <div class="item-header" [ngClass]="{'item-header-disable': item.storage < storage }">
                                                <div class="item-name"  [ngClass]="{'item-name-disable': item.storage < storage }">
                                                    <span>{{item.servicePackName}}</span>
                                                    <div class="item-price">
                                                        <div class="price">
                                                            <span>{{ item.price | number: '1.0-0' }}</span><br>
                                                            <span class="unit-price">đ/tháng</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="item-body">
                                                {{item.broker}} Broker - {{item.cpu}} VCPU / <br>
                                                {{item.ram}}GB RAM / <br>
                                                {{item.storage}}GB SDD
                                            </div>
                                        </div>
                                    </div>
                                    <ul class="myPoint" NguCarouselPoint>
                                        <li *ngFor="let j of myCarousel.pointNumbers"
                                            [class.active]="j === myCarousel.activePoint"
                                            (click)="myCarousel.moveTo(j)">
                                        </li>
                                    </ul>
                                </ngu-carousel>
                            </ng-template>
                        </nz-tab>

                        <nz-tab nzTitle="Cấu hình tùy chọn">
                            <div nz-row class="customize-config">
                                <div nz-col [nzSpan]="5">
                                    <nz-form-item>
                                        <nz-form-label [nzSm]="24" [nzXs]="24" nzRequired>Số Broker</nz-form-label>
                                        <nz-form-control [nzSm]="24" [nzXs]="24"
                                            nzErrorTip="Vui lòng nhập số lượng Broker">
                                            <input nz-input type="number" formControlName="broker" id="broker" autofocus
                                                nzSize="large" />
                                        </nz-form-control>
                                    </nz-form-item>
                                </div>

                                <div nz-col [nzSpan]="5">
                                    <nz-form-item>
                                        <nz-form-label [nzSm]="24" [nzXs]="24" nzRequired>vCPU</nz-form-label>
                                        <nz-form-control [nzSm]="24" [nzXs]="24"
                                            nzErrorTip="Vui lòng nhập giá trị vCpu">
                                            <input nz-input type="number" formControlName="vCpu" id="vCpu" autofocus
                                                nzSize="large" />
                                        </nz-form-control>
                                    </nz-form-item>
                                </div>

                                <div nz-col [nzSpan]="5" class="config-suffix">
                                    <nz-form-item>
                                        <nz-form-label [nzSm]="24" [nzXs]="24" nzRequired>RAM</nz-form-label>
                                        <nz-form-control [nzSm]="24" [nzXs]="24" nzErrorTip="Vui lòng nhập giá trị Ram">
                                            <nz-input-group nzSuffix="(GB)" nzSize="large">
                                                <input nz-input type="number" formControlName="ram" id="ram"
                                                    autofocus />
                                            </nz-input-group>
                                        </nz-form-control>
                                    </nz-form-item>
                                </div>

                                <div nz-col [nzSpan]="5" class="config-suffix">
                                    <nz-form-item>
                                        <nz-form-label [nzSm]="24" [nzXs]="24" nzRequired>Storage</nz-form-label>
                                        <nz-form-control [nzSm]="24" [nzXs]="24" [nzErrorTip]="storageErrorTpl">
                                            <nz-input-group nzSuffix="(GB)" nzSize="large">
                                                <input nz-input type="number" formControlName="storage" id="storage"
                                                    autofocus />
                                            </nz-input-group>
                                            <ng-template #storageErrorTpl let-control>
                                                <ng-container *ngIf="control.hasError('required')">
                                                    Vui lòng nhập giá trị Storage
                                                </ng-container>
                                                <ng-container *ngIf="control.hasError('min')">
                                                    Vui lòng nhập giá trị Storage lớn hơn hoặc bằng {{storage}}
                                                </ng-container>
                                            </ng-template>
                                        </nz-form-control>
                                    </nz-form-item>
                                </div>
                            </div>

                        </nz-tab>
                    </nz-tabset>

                    <!-- <nz-form-item>
                        <nz-form-label [nzXs]="24" [nzSm]="24" nzRequired>Thời hạn sử dụng (tháng)</nz-form-label>
                        <nz-form-control [nzXs]="24" [nzSm]="5" nzErrorTip="Vui lòng nhập thời hạn sử dụng">
                            <input nz-input type="number" formControlName="usageTime" id="usageTime" autofocus
                                nzSize="large" (change)="onChangeUsageTime()" />
                        </nz-form-control>
                    </nz-form-item> -->
                </nz-card>

            </form>
        </div>

        <!-- payment -->
        <div nz-col [nzSpan]="8">
            <nz-card class="price-card">
                <h3><b>Thành tiền</b></h3>
                <div nz-row [nzGutter]="8">
                    <div nz-col [nzSpan]="12">
                        <div class="label-price">Chi phí vCPU</div>
                        <div class="label-quantity">{{pricePerCpu | number: '1.0-0'}} đồng x {{cpu}} vCPU</div>
                    </div>
                    <div nz-col [nzSpan]="12">
                        <div class="value-price">{{ pricePerCpu * cpu | number: '1.0-0'}} VNĐ</div>
                        <div class="unit-total">VNĐ/tháng</div>
                    </div>
                </div>
                <nz-divider class="divider-style"></nz-divider>
                <div nz-row [nzGutter]="8">
                    <div nz-col [nzSpan]="12">
                        <div class="label-price">Chi phí RAM</div>
                        <div class="label-quantity">{{pricePerRam | number: '1.0-0'}} đồng x {{ram}} GB</div>
                    </div>
                    <div nz-col [nzSpan]="12">
                        <div class="value-price">{{ pricePerRam * ram | number: '1.0-0'}} VNĐ</div>
                        <div class="unit-total">VNĐ/tháng</div>
                    </div>
                </div>
                <nz-divider class="divider-style"></nz-divider>
                <div nz-row [nzGutter]="8">
                    <div nz-col [nzSpan]="12">
                        <div class="label-price">Chi phí Storage</div>
                        <div class="label-quantity">{{pricePerStorage | number: '1.0-0'}} đồng x {{storage}} GB</div>
                    </div>
                    <div nz-col [nzSpan]="12">
                        <div class="value-price">{{ pricePerStorage * storage | number: '1.0-0'}} VNĐ</div>
                        <div class="unit-total">VNĐ/tháng</div>
                    </div>
                </div>
                <nz-divider class="divider-style"></nz-divider>
                <div nz-row [nzGutter]="8">
                    <div nz-col [nzSpan]="12">
                        <div class="label-price" style="margin-bottom: 10px;">Thời hạn sử dụng</div>
                        <!-- <div class="label-quantity">- Ngày bắt đầu sử dụng: </div>
                        <div class="label-quantity">- Ngày hết hạn: </div> -->
                    </div>
                    <div nz-col [nzSpan]="12">
                        <div class="value-usage-time" style="margin-bottom: 10px;">{{ usageTime }} tháng</div>
                        <!-- <div class="unit-total" style="margin-bottom: 12px;">{{ itemDetail.createdDate | date : 'dd/MM/yyyy' }}</div>
                        <div class="unit-total">{{ expiryDate | date : 'dd/MM/yyyy' }}</div> -->
                    </div>
                </div>
                <nz-divider class="divider-style"></nz-divider>

                <div nz-row [nzGutter]="8" class="mt-5 price-panel">
                    <div nz-col [nzSpan]="12">
                        <div class="label-price">Tổng cần thanh toán</div>
                        <div class="label-quantity"><i>(Chưa bao gồm 10% VAT)</i></div>
                    </div>
                    <div nz-col [nzSpan]="12">
                        <div class="value-price total-price">{{ (pricePerCpu * cpu + pricePerRam * ram + pricePerStorage * storage) * usageTime * 1.1 | number: '1.0-0'}} VNĐ</div>
                        <div class="unit-total">VNĐ/tháng</div>
                    </div>
                </div>

                <div nz-row class="mt-5" [nzGutter]="16" nzJustify="center">
                    <div nz-col [nzSpan]="12">
                        <button nz-button nzType="default" nzBlock (click)="backToList()">
                            <img style="padding-right: 10px; margin-top: -4px" src="assets/imgs/cancel.svg" alt="" />
                            <b>Hủy</b>
                        </button>
                    </div>

                    <div nz-col [nzSpan]="12">
                        <button nz-button nzType="primary" nzBlock [disabled]="myform.invalid"
                            (click)="onSubmitPayment()">
                            <img style="padding-right: 10px; margin-top: -4px; height: 20px;"
                                src="assets/imgs/upgrade-white.svg" alt="" />
                            <b>Nâng cấp</b>
                        </button>
                    </div>
                </div>
            </nz-card>
        </div>
    </div>
</ng-container>