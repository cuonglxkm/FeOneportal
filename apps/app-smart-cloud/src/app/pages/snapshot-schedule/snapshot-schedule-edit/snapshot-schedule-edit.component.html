<page-header
  [breadcrumb]="breadcrumb"
  [action]="action"
  [title]="'Chỉnh sửa lịch Snapshot'"
>
  <ng-template #breadcrumb>
    <nz-breadcrumb>
      <nz-breadcrumb-item>
        <a [routerLink]="['/']">Home</a>
      </nz-breadcrumb-item>
      <nz-breadcrumb-item>
        <a [routerLink]="['/app-smart-cloud/schedule/snapshot/list']"
          >Lịch Snapshot</a
        >
      </nz-breadcrumb-item>
      <nz-breadcrumb-item> Chỉnh sửa lịch Snapshot</nz-breadcrumb-item>
    </nz-breadcrumb>
  </ng-template>
  <ng-template #action>
    <div class="alain-custom-action text-right">
      <region-select-dropdown
        (valueChanged)="onRegionChange($event)"
      ></region-select-dropdown>
      <project-select-dropdown
        [regionId]="region"
        (valueChanged)="onProjectChange($event)"
      ></project-select-dropdown>
    </div>
  </ng-template>
</page-header>

<nz-card [nzBordered]="false" nzTitle="Thông tin lịch Snapshot">
  <form nz-form [formGroup]="form" [nzLayout]="'vertical'">
    <nz-spin [nzSpinning]="isLoading" nzSize="large">
      <nz-form-item>
        <nz-form-label nzFor="name" nzRequired>Tên lịch Snapshot</nz-form-label>
        <nz-form-control nzDisableAutoTips [nzErrorTip]="nameErrorTpl">
          <input
            nz-input
            formControlName="name"
            [(ngModel)]="scheduleSnapshot.name"
            id="name"
            placeholder="Nhập tên lịch Snapshot"
            maxlength="64"
            minlength="1"
          />
          <span class="nameField"
            >Tên lịch Snapshot có thể có tối đa 64 ký tự. Ký tự hợp lệ: A-Z,
            a-z, 0-9</span
          >
          <ng-template #nameErrorTpl let-control>
            <ng-container *ngIf="control.hasError('required')"
              >Vui lòng nhập tên lịch Snapshot
            </ng-container>
            <ng-container *ngIf="control.hasError('pattern')"
              >Tên lịch Snapshot không hợp lệ
            </ng-container>
          </ng-template>
        </nz-form-control>
      </nz-form-item>

      <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired
        >Chọn Volume</nz-form-label
      >
      <nz-select
        nzSize="default"
        [nzShowSearch]="true"
        [nzPlaceHolder]="'-Chọn tên Volume-'"
        [(ngModel)]="scheduleSnapshot.serviceId"
        [ngModelOptions]="{ standalone: true }"
        style="width: 100%"
      >
        <nz-option
          *ngFor="let item of volumeList"
          [nzLabel]="item.label.toString()"
          [nzValue]="item.value"
        ></nz-option>
      </nz-select>
      <br />
      <br />

      <nz-form-label [nzSm]="6" [nzXs]="24">Chế độ Snapshot</nz-form-label>
      <input nz-input placeholder="Theo tuần" disabled="true" type="text" />
      <br />
      <br />

      <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired
        >Chọn thời điểm thực hiện Snapshot</nz-form-label
      >
      <nz-time-picker
        style="width: 100%"
        [(ngModel)]="scheduleSnapshot.runtime"
        [ngModelOptions]="{ standalone: true }"
        [nzDefaultOpenValue]="defaultOpenValue"
      ></nz-time-picker>
      <br />
      <br />

      <nz-form-label [nzSm]="6" [nzXs]="24">Số tuần</nz-form-label>
      <input nz-input placeholder="1 tuần" disabled="true" type="text" />
      <br />
      <br />

      <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired>Chọn ngày</nz-form-label>
      <nz-select
        nzSize="default"
        [nzShowSearch]="true"
        [(ngModel)]="scheduleSnapshot.daysOfWeek"
        [ngModelOptions]="{ standalone: true }"
        style="width: 100%"
      >
        <nz-option
          *ngFor="let item of dateList"
          [nzLabel]="item.label.toString()"
          [nzValue]="item.value"
        ></nz-option>
      </nz-select>
      <br />
      <br />

      <nz-form-label [nzSm]="6" [nzXs]="24"
        >Số bản Snapshot lưu trữ</nz-form-label
      >
      <input nz-input placeholder="1" disabled="true" type="text" />
      <br />
      <br />

      <nz-form-label [nzSm]="6" [nzXs]="24">Mô tả</nz-form-label>
      <textarea
        rows="4"
        nz-input
        [(ngModel)]="scheduleSnapshot.description"
        [ngModelOptions]="{ standalone: true }"
      ></textarea>
    </nz-spin>
  </form>
</nz-card>

<div
  class="text-right"
  style="
    display: flex;
    align-items: center;
    justify-content: flex-end;
    height: 100%;
  "
>
  <button
    (click)="goBack()"
    nz-button
    nzType="primary"
    style="border: none; background-color: gray"
  >
    Quay lại
  </button>
  <button
    [disabled]="!form.valid"
    (click)="update()"
    nz-button
    nzType="primary"
    style="border: none"
  >
    Chỉnh sửa
  </button>
</div>
