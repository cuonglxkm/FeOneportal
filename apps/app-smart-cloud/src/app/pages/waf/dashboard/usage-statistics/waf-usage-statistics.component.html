<nz-spin [nzSpinning]="isSpinning">
  <nz-content>
    <nz-card>
      <div nz-row>
        <nz-range-picker [(ngModel)]="selectedDate" nzAllowClear="false" (ngModelChange)="onDateChange($event)" [nzDisabledDate]="disabledDate"></nz-range-picker>
        <nz-select [(ngModel)]="selectedDomain"
                    (ngModelChange)="onChangeDomain()"
                     [nzMaxTagCount]="0"
                     [nzMaxTagPlaceholder]="tagPlaceHolder"
                     nzSize="default"
                     style="margin-left: 10px; width: 200px;"
                     nzPlaceHolder="Chọn domain"
                     nzTooltipPlacement="bottom"
                     nz-tooltip
                     nzMode="multiple"
                     nzAllowClear="true"
                     [nzStatus]="!isValid?'error':''" >
          <nz-option *ngFor="let item of selectDomainOptions" [nzValue]="item.value" [nzLabel]="item.label"></nz-option>
        </nz-select>
        <ng-template #tagPlaceHolder let-selectedList>{{ selectedList.length }} domain selected</ng-template>
        <button style="margin-left: 10px" nz-button nzType="primary" (click)="queryDomain()">Query</button>
      </div>
      <div nz-row class="pt-5">
        <button nz-button [nzType]="this.currentTab=='bandwidth'? 'primary':'default'" (click)="changeTab('bandwidth')">Bandwidth/Traffic</button>
        <button nz-button [nzType]="this.currentTab=='requests'? 'primary':'default'" (click)="changeTab('requests')">Requests</button>
        <nz-select [(ngModel)]="selectedTypeDate"
                     nzSize="default"
                     style="margin-left: 10px; width: 200px;"
                     disabled="true">
          <nz-option nzLabel="Hourly" nzValue="hourly"></nz-option>
          <nz-option nzLabel="5 minutes" nzValue="fiveminutes"></nz-option>
        </nz-select>
      </div>
  
      <div nz-row class="pt-5 pb-5">
        <span class="border-left-text">Trend</span>
      </div>
  
      <nz-card>
        <p>
          <span style="color: #4168FF;">Edge &nbsp;&nbsp;</span>
          <span *ngIf="this.selectedTypeDate=='fiveminutes'" class="peak">Peak Bandwidth : <span style="color: #512DA8; font-weight: bold">{{this.peakEdge?.bandwidth}} Mbps </span>({{this.peakEdge?.timestamp}}) </span>
          <span class="ml-5">Total Traffic: <span style="color: #512DA8; font-weight: bold">{{this.currentTab=='bandwidth'?this.totalEdgeTraffic:0.00}} GB</span></span>
        </p>
        <p>
          <span style="color: #47CBFF;">Back- to - Origin &nbsp;&nbsp;</span>
          <span *ngIf="this.selectedTypeDate=='fiveminutes'" class="peak">Peak Bandwidth : <span style="color: #512DA8; font-weight: bold">{{this.peakB2O?.bandwidth}} Mbps </span>({{this.peakB2O?.timestamp}}) </span>
          <span class="ml-5">Total Traffic: <span style="color: #512DA8; font-weight: bold">{{this.currentTab=='bandwidth'?this.totalB2OTraffic:0.00}} GB</span></span>
        </p>
        <p>
          <span style="color: #009B4E;">{{this.currentTab=='bandwidth'?'Bandwidth Saving Ratio':'Hit Ratio'}} &nbsp;&nbsp;</span>
          <span *ngIf="this.selectedTypeDate=='fiveminutes'" class="peak">Peak Value : <span style="color: #512DA8; font-weight: bold">{{this.peakSaving?.savingBandwidth}}% </span>({{this.peakSaving?.timestamp}}) </span>
          <span class="ml-5">Average: <span style="color: #512DA8; font-weight: bold">{{this.averageBandwidthSaving}}%</span></span>
        </p>
      </nz-card>
  
      <div echarts [options]="options" class="demo-chart" style="height: 500px"></div>
  
      <nz-alert nzType="warning" nzMessage="Mô tả chức năng: Độ chi tiết của biểu đồ là 5 phút khi phạm vi tìm kiểm nhỏ hơn 1 ngày, biểu đồ sẽ thay đổi thành độ chi tiết theo giờ khi phạm vi tìm kiếm trên 1 ngày" nzShowIcon></nz-alert>
  
      <div nz-row class="pt-5 pb-5">
        <span class="border-left-text">Daily Data</span>
        <nz-select [(ngModel)]="selectedTypeRequest"
                     nzSize="default"
                     style="margin-left: 10px; width: 200px;"
                     (ngModelChange)="changeTypeRequest()"
        >
          <nz-option nzLabel="Edge" nzValue="EDGE"></nz-option>
          <nz-option nzLabel="Back-to-Origin" nzValue="B2O"></nz-option>
          <nz-option nzLabel="Bandwidth Saving Ratio" nzValue="BSR"></nz-option>
        </nz-select>
      </div>
  
      <nz-table #fixedTable
                style="margin-top: 20px;"
                nzShowSizeChanger
                [nzData]="peakTable"
                [nzLoading]="dailyTableLoading">
        <thead>
        <tr>
          <th nzLeft>Date</th>
          <th nzBreakWord>Bandwidth Peak Time</th>
          <th nzBreakWord>Peak Bandwidth (Mbps)</th>
          <th nzBreakWord>Total Traffic (GB)</th>
        </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let data of fixedTable.data">
            <tr>
              <td nzLeft>{{ data.date }}</td>
              <td nzBreakWord nzAlign="left">{{ data.time }}</td>
              <td nzBreakWord nzAlign="left">{{ data.bandwidth }} </td>
              <td nzBreakWord nzAlign="left">{{ data.sslCertId ? 'ENABLE' : 'DISABLE' }}</td>
            </tr>
          </ng-container>
        </tbody>
      </nz-table>
  
  
      <div nz-row class="pt-5 pb-5">
        <span class="border-left-text">Bandwidth Saving Ratio TOP 10 domain</span>
      </div>
      <nz-table #fixedTable
                style="margin-top: 20px;"
                nzShowSizeChanger
                [nzData]="[]"
                [nzLoading]="dailyTableLoading">
        <thead>
        <tr>
          <th nzLeft>Rank</th>
          <th nzBreakWord>Domain</th>
          <th nzBreakWord>Peak Value (%)</th>
          <th nzBreakWord>Average (%)</th>
        </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let data of fixedTable.data">
            <tr>
              <td nzLeft>{{ data.domain }}</td>
              <td nzBreakWord nzAlign="left">{{ data.ipPublic }}</td>
              <td nzBreakWord nzAlign="left">{{ data.cName }} </td>
              <td nzBreakWord nzAlign="left">{{ data.sslCertId ? 'ENABLE' : 'DISABLE' }}</td>
            </tr>
          </ng-container>
        </tbody>
      </nz-table>
    </nz-card>
  </nz-content>
</nz-spin>


 