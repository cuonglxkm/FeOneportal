<span class="titlecard-custom">{{ 'app.set' | i18n }} Lifecycle</span>
<div style="margin-top: 20px; margin-bottom: 10px" class="text-label">
  <span> {{ 'app.lifeCycle.config.intro' | i18n }}</span
  ><br /><br />
  <span>
    {{ 'app.lifeCycle.config.intro.next' | i18n }}
  </span>
</div>
<div class="text-right p-0 m-b-0">
  <nz-input-group
    style="margin-right: 8px; width: 25%; border-radius: 8px"
    [nzPrefix]="prefixIconSearch"
    nzSize="large"
  >
    <input
      name="name"
      nz-input
      [placeholder]="'app.placeholder.search' | i18n"
      [(ngModel)]="inputSearch"
    />
  </nz-input-group>
  <ng-template #prefixIconSearch>
    <img
      src="assets/imgs/search.svg"
      alt=""
      style="cursor: pointer"
      [nz-tooltip]="'app.button.search' | i18n"
      (click)="searchLifeCycle()"
    />
  </ng-template>
  <button nz-button nzType="primary" (click)="modalCreate()">
    <img
      style="padding-right: 10px; margin-top: -4px"
      src="assets/imgs/add-circle.svg"
      alt=""
    />
    <span>{{ 'app.lifeCycle.create' | i18n }}</span>
  </button>
</div>
<nz-table
  style="margin-top: 10px"
  #rowSelectionTable
  nzShowSizeChanger
  [nzFrontPagination]="false"
  [nzData]="listLifecycle"
  (nzPageIndexChange)="searchLifeCycle()"
  (nzPageSizeChange)="searchLifeCycle()"
  nzTableLayout="fixed"
  [nzLoading]="loading"
>
  <thead>
    <tr>
      <th nzTableLayout="fixed">{{ 'app.text.status' | i18n }}</th>
      <th nzTableLayout="fixed">{{ 'app.prefix' | i18n }}</th>
      <th nzTableLayout="fixed">{{ 'app.filter' | i18n }} (Key:Value)</th>
      <th nzTableLayout="fixed">{{ 'app.delete.file.current.version' | i18n }}</th>
      <th nzTableLayout="fixed">{{ 'app.delete.file.non.current.version' | i18n }}</th>
      <th nzTableLayout="fixed">{{ 'app.delete.multi.upload' | i18n }}</th>
      <th nzTableLayout="fixed">{{ 'app.text.operation' | i18n }}</th>
    </tr>
  </thead>
  <tbody>
    <ng-container *ngFor="let item of listLifecycle">
      <tr>
        <td>
          {{ item.enabledString }}
        </td>
        <td>{{ item.prefix }}</td>
        <td>{{ item.lifecycleTagPredicateString }}</td>
        <td>{{ item.expiration_DayString }}</td>
        <td>{{ item.noncurrentVersionExpiration_DayString }}</td>
        <td>{{ item.abortIncompleteMultipartUpload_DayString }}</td>
        <td nzRight>
          <img
            src="assets/imgs/edit-2.svg"
            alt=""
            (click)="modalUpdate(item)"
            style="cursor: pointer; margin-right: 16px"
            [nz-tooltip]="'app.text.edit' | i18n"
          />
          <img
            src="assets/imgs/delete.svg"
            alt=""
            (click)="modalDelete(item)"
            style="cursor: pointer; margin-right: 16px"
            [nz-tooltip]="'app.text.delete' | i18n"
          />
        </td>
      </tr>
    </ng-container>
  </tbody>
</nz-table>

<nz-modal
  [(nzVisible)]="isVisibleCreate"
  [nzTitle]="'app.lifeCycle.create' | i18n"
  (nzOnCancel)="handleCancelCreate()"
>
  <ng-container *nzModalContent>
    <label
      class="text-label"
      nz-checkbox
      [(ngModel)]="lifecycleCreate.enabled"
      [ngModelOptions]="{ standalone: true }"
      >{{ 'app.enable.filter' | i18n }}</label
    >
    <div style="margin-top: 16px" class="text-label">
      {{ 'app.prefix' | i18n }}
      <img
      style="padding-right: 10px; margin-top: -4px"
      [nz-tooltip]="'app.lifeCycle.tooltip.prefix' | i18n"
      src="assets/imgs/pajamas_question.svg"
      alt=""
    />
    </div>
    <input
      style="margin-bottom: 16px; margin-top: 5px"
      class="input-custom"
      nz-input
      [placeholder]="'app.input.prefix' | i18n"
      [(ngModel)]="lifecycleCreate.prefix"
      [ngModelOptions]="{ standalone: true }"
    />
    <div class="text-label">
      {{ 'app.filter.by.tag' | i18n
      }}<img
        style="margin-left: 5px"
        src="assets/imgs/ei_plus.svg"
        alt=""
        (click)="addTag()"
      />
    </div>
    <div
      class="text-label"
      style="color: #eb1414; margin-top: 16px; margin-bottom: 10px"
    >
      {{ 'app.lifeCycle.note' | i18n }}
    </div>
    <div *ngFor="let item of listTag">
      <div style="display: flex">
        <div style="flex: 5; padding-right: 16px">
          <input
            style="margin-bottom: 8px"
            class="input-custom"
            nz-input
            [placeholder]="'app.input.key' | i18n"
            [(ngModel)]="item.key"
            [ngModelOptions]="{ standalone: true }"
          />
        </div>
        <div style="flex: 5">
          <input
            style="margin-bottom: 8px"
            class="input-custom"
            nz-input
            [placeholder]="'app.input.value' | i18n"
            [(ngModel)]="item.value"
            [ngModelOptions]="{ standalone: true }"
          />
        </div>
        <div
          style="margin-left: 10px"
          class="d-flex align-items-center justify-content-end"
        >
          <img
            style="cursor: pointer"
            src="assets/imgs/trash1.svg"
            alt=""
            (click)="delelteTag(item.id)"
          />
        </div>
      </div>
    </div>
    <label
      class="text-label"
      style="margin-top: 16px"
      nz-checkbox
      [(ngModel)]="lifecycleCreate.isSetExpiration_Day"
      [ngModelOptions]="{ standalone: true }"
      >{{ 'app.delete.file.current.version' | i18n }}</label
    >
    <div style="display: flex; margin-top: 5px">
      <div style="flex: 2; padding-right: 16px">
        <nz-input-number
          style="width: 100%; margin-left: 0px"
          [nzMin]="1"
          [nzMax]="30"
          [nzStep]="1"
          [(ngModel)]="lifecycleCreate.lifecycleRuleExpiration_Day"
          [ngModelOptions]="{ standalone: true }"
          nzSize="large"
        ></nz-input-number>
      </div>
      <div
        class="text-label"
        style="flex: 3; display: flex; align-items: center"
      >
        {{ 'app.lifeCycle.text.input1' | i18n }}
      </div>
    </div>
    <label
      class="text-label"
      style="margin-top: 16px"
      nz-checkbox
      [(ngModel)]="lifecycleCreate.isSetNoncurrentVersionExpiration_Day"
      [ngModelOptions]="{ standalone: true }"
      >{{ 'app.delete.file.non.current.version' | i18n }}</label
    >
    <div style="display: flex; margin-top: 5px">
      <div style="flex: 2; padding-right: 16px">
        <nz-input-number
          style="width: 100%; margin-left: 0px"
          [nzMin]="1"
          [nzMax]="30"
          [nzStep]="1"
          [(ngModel)]="
            lifecycleCreate.lifecycleRuleNoncurrentVersionExpiration_Day
          "
          [ngModelOptions]="{ standalone: true }"
          nzSize="large"
        ></nz-input-number>
      </div>
      <div
        class="text-label"
        style="flex: 3; display: flex; align-items: center"
      >
        {{ 'app.lifeCycle.text.input2' | i18n }}
      </div>
    </div>
    <label
      class="text-label"
      style="margin-top: 16px"
      nz-checkbox
      [(ngModel)]="lifecycleCreate.isSetAbortIncompleteMultipartUpload_Day"
      [ngModelOptions]="{ standalone: true }"
      >{{ 'app.delete.multi.upload' | i18n }}</label
    >
    <div style="display: flex; margin-top: 5px">
      <div style="flex: 2; padding-right: 16px">
        <nz-input-number
          style="width: 100%; margin-left: 0px"
          [nzMin]="1"
          [nzMax]="30"
          [nzStep]="1"
          [(ngModel)]="
            lifecycleCreate.lifecycleRuleAbortIncompleteMultipartUpload_Day
          "
          [ngModelOptions]="{ standalone: true }"
          nzSize="large"
        ></nz-input-number>
      </div>
      <div
        class="text-label"
        style="flex: 3; display: flex; align-items: center"
      >
        {{ 'app.lifeCycle.text.input3' | i18n }}
      </div>
    </div>
  </ng-container>
  <div *nzModalFooter>
    <button nz-button (click)="handleCancelCreate()">
      <img
        style="padding-right: 10px; margin-top: -4px"
        src="assets/imgs/cancel.svg"
        alt=""
      />{{ 'app.button.cancel' | i18n }}
    </button>
    <button nz-button nzType="primary" (click)="handleOkCreate()">
      <img
        style="padding-right: 10px; margin-top: -4px"
        src="assets/imgs/confirm.svg"
        alt=""
      />{{ 'app.button.confirm' | i18n }}
    </button>
  </div>
</nz-modal>

<nz-modal
  [(nzVisible)]="isVisibleDelete"
  nzTitle="Xác nhận xóa Lifecycle"
  (nzOnCancel)="handleCancelDelete()"
>
  <ng-container *nzModalContent>
    <div>Quý khách muốn thực hiện xóa Lifecycle?</div>
  </ng-container>
  <div *nzModalFooter>
    <button nz-button (click)="handleCancelDelete()">
      <img
        style="padding-right: 10px; margin-top: -4px"
        src="assets/imgs/cancel.svg"
        alt=""
      />{{ 'app.button.cancel' | i18n }}
    </button>
    <button nz-button nzType="primary" (click)="handleOkDelete()">
      <img
        style="padding-right: 10px; margin-top: -4px"
        src="assets/imgs/confirm.svg"
        alt=""
      />
      {{ 'app.button.confirm' | i18n }}
    </button>
  </div>
</nz-modal>

<nz-modal
  [(nzVisible)]="isVisibleUpdate"
  [nzTitle]="'app.lifeCycle.edit' | i18n"
  (nzOnCancel)="handleCancelUpdate()"
>
  <ng-container *nzModalContent>
    <label
      class="text-label"
      nz-checkbox
      [(ngModel)]="lifecycleUpdate.enabled"
      [ngModelOptions]="{ standalone: true }"
      >{{ 'app.enable.filter' | i18n }}</label
    >
    <div style="margin-top: 16px" class="text-label">
      {{ 'app.prefix' | i18n }}
      <img
        style="padding-right: 10px; margin-top: -4px"
        [nz-tooltip]="'app.lifeCycle.tooltip.prefix' | i18n"
        src="assets/imgs/message-question.svg"
        alt=""
      />
    </div>
    <input
      style="margin-bottom: 16px; margin-top: 5px"
      class="input-custom"
      nz-input
      [placeholder]="'app.input.prefix' | i18n"
      [(ngModel)]="lifecycleUpdate.prefix"
      [ngModelOptions]="{ standalone: true }"
    />
    <div class="text-label">
      {{ 'app.filter.by.tag' | i18n
      }}<img
        style="margin-left: 5px"
        src="assets/imgs/ei_plus.svg"
        alt=""
        (click)="addTag()"
      />
    </div>
    <div
      class="text-label"
      style="color: #eb1414; margin-top: 16px; margin-bottom: 10px"
    >
      {{ 'app.lifeCycle.note' | i18n }}
    </div>
    <div *ngFor="let item of listTag">
      <div style="display: flex">
        <div style="flex: 5; padding-right: 16px">
          <input
            style="margin-bottom: 8px"
            class="input-custom"
            nz-input
            [placeholder]="'app.input.key' | i18n"
            [(ngModel)]="item.key"
            [ngModelOptions]="{ standalone: true }"
          />
        </div>
        <div style="flex: 5">
          <input
            style="margin-bottom: 8px"
            class="input-custom"
            nz-input
            [placeholder]="'app.input.value' | i18n"
            [(ngModel)]="item.value"
            [ngModelOptions]="{ standalone: true }"
          />
        </div>
        <div
          style="margin-left: 10px"
          class="d-flex align-items-center justify-content-end"
        >
          <img
            style="cursor: pointer"
            src="assets/imgs/trash1.svg"
            alt=""
            (click)="delelteTag(item.id)"
          />
        </div>
      </div>
    </div>
    <label
      class="text-label"
      style="margin-top: 16px"
      nz-checkbox
      [(ngModel)]="lifecycleUpdate.isSetExpiration_Day"
      [ngModelOptions]="{ standalone: true }"
      >{{ 'app.delete.file.current.version' | i18n }}</label
    >
    <div style="display: flex; margin-top: 5px">
      <div style="flex: 2; padding-right: 16px">
        <nz-input-number
          style="width: 100%; margin-left: 0px"
          [nzMin]="1"
          [nzMax]="30"
          [nzStep]="1"
          [(ngModel)]="lifecycleUpdate.lifecycleRuleExpiration_Day"
          [ngModelOptions]="{ standalone: true }"
          nzSize="large"
        ></nz-input-number>
      </div>
      <div
        class="text-label"
        style="flex: 3; display: flex; align-items: center"
      >
        {{ 'app.lifeCycle.text.input1' | i18n }}
      </div>
    </div>
    <label
      class="text-label"
      style="margin-top: 16px"
      nz-checkbox
      [(ngModel)]="lifecycleUpdate.isSetNoncurrentVersionExpiration_Day"
      [ngModelOptions]="{ standalone: true }"
      >{{ 'app.delete.file.non.current.version' | i18n }}</label
    >
    <div style="display: flex; margin-top: 5px">
      <div style="flex: 2; padding-right: 16px">
        <nz-input-number
          style="width: 100%; margin-left: 0px"
          [nzMin]="1"
          [nzMax]="30"
          [nzStep]="1"
          [(ngModel)]="
            lifecycleUpdate.lifecycleRuleNoncurrentVersionExpiration_Day
          "
          [ngModelOptions]="{ standalone: true }"
          nzSize="large"
        ></nz-input-number>
      </div>
      <div
        class="text-label"
        style="flex: 3; display: flex; align-items: center"
      >
        {{ 'app.lifeCycle.text.input2' | i18n }}
      </div>
    </div>
    <label
      class="text-label"
      style="margin-top: 16px"
      nz-checkbox
      [(ngModel)]="lifecycleUpdate.isSetAbortIncompleteMultipartUpload_Day"
      [ngModelOptions]="{ standalone: true }"
      >{{ 'app.delete.multi.upload' | i18n }}</label
    >
    <div style="display: flex; margin-top: 5px">
      <div style="flex: 2; padding-right: 16px">
        <nz-input-number
          style="width: 100%; margin-left: 0px"
          [nzMin]="1"
          [nzMax]="30"
          [nzStep]="1"
          [(ngModel)]="
            lifecycleUpdate.lifecycleRuleAbortIncompleteMultipartUpload_Day
          "
          [ngModelOptions]="{ standalone: true }"
          nzSize="large"
        ></nz-input-number>
      </div>
      <div
        class="text-label"
        style="flex: 3; display: flex; align-items: center"
      >
        {{ 'app.lifeCycle.text.input3' | i18n }}
      </div>
    </div>
  </ng-container>
  <div *nzModalFooter>
    <button nz-button (click)="handleCancelUpdate()">
      <img
        style="padding-right: 10px; margin-top: -4px"
        src="assets/imgs/cancel.svg"
        alt=""
      />{{ 'app.button.cancel' | i18n }}
    </button>
    <button nz-button nzType="primary" (click)="handleOkUpdate()">
      <img
        style="padding-right: 10px; margin-top: -4px"
        src="assets/imgs/confirm.svg"
        alt=""
      />{{ 'app.button.confirm' | i18n }}
    </button>
  </div>
</nz-modal>
