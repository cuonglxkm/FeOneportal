<one-portal-header
  [title]="'app.breadcrumb.attach-policy' | i18n"
  [path]="['app.breadcrumb.home' | i18n , 'IAM', 'Policies', 'app.breadcrumb.attach-policy' | i18n ]"
  [regionId]="region"
  (onProjectChanged)="projectChanged($event)" (onRegionChanged)="regionChanged($event)"
/>


<nz-content class="content">

  <nz-card class="content-header" [nzTitle]="'app.breadcrumb.attach-policy.title' | i18n">
    <p style="opacity: 0.5;">{{'app.breadcrumb.attach-policy.des' | i18n}}</p>
  </nz-card>

  <nz-card class="content-body" [nzTitle]="'app.breadcrumb.attach-policy.iamEntities' | i18n">
    <p style="opacity: 0.5;">{{'app.breadcrumb.attach-policy.iamEntities.des' | i18n}}</p>
    <div style="display: flex; justify-content: space-between;">
      <div class="text-left">
        <nz-form-label [nzFor]="'volumeStatus'"><b>{{'app.breadcrumb.attach-policy.iamEntities.type' | i18n}}</b></nz-form-label>
        <nz-select nzSize="large"
                   [nzPlaceHolder]="'app.group-detail.allTypes' | i18n"
                   [nzOptions]="optionsEntities"
                   [(ngModel)]="typeSearch"
                   (ngModelChange)="searchEntities()"
                   style="width: 170px;"
        >
        </nz-select>
      </div>
      <div class="text-right">
        <nz-input-group style="margin-left: 15px;margin-right: 8px; width: 250px; margin-bottom: 10px"
                        [nzSuffix]="suffixIconSearch" nzSize="large">
          <input #searchBox [(ngModel)]="entitiesNameSearch" type="text" nz-input [placeholder]="'app.users.search' | i18n"/>
        </nz-input-group>
        <ng-template #suffixIconSearch>
          <img src="assets/imgs/search.svg" alt="" style="cursor: pointer" [nz-tooltip]="'app.button.search' | i18n"
               (click)="searchEntities()"/>
        </ng-template>
        <button class="button-custom" nz-button style="color: var(--Primary-1, #0066b3)" (click)="reload()" nzSize="large">
          <img style="margin-top: -4px;" src="assets/imgs/refresh.svg" alt=""/>
        </button>
      </div>
    </div>
    <p><i style="opacity: 0.5;">{{'app.breadcrumb.attach-policy.iamEntities.option' | i18n}}</i></p>
    <nz-table
      class="table-data"
      #rowSelectionTable
      [nzData]="listOfData"
      nzShowSizeChanger
      [nzFrontPagination]="false"
      [nzTotal]="totalData"
      [nzPageSize]="pageSize"
      [nzPageIndex]="currentPage"
      [nzLoading]="isLoadingEntities"
      (nzQueryParams)="onQueryParamsChange($event)"
      (nzCurrentPageDataChange)="onCurrentPageDataChange($event)"
    >
      <thead>
      <tr>
        <th
          [nzChecked]="checked"
          [nzIndeterminate]="indeterminate"
          (nzCheckedChange)="onAllChecked($event)"
        ></th>
        <th>{{'app.breadcrumb.attach-policy.iamEntities.name' | i18n}}</th>
        <th>{{'app.breadcrumb.attach-policy.iamEntities.type' | i18n}}</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let data of rowSelectionTable.data">
        <td
          [nzChecked]="setOfCheckedId.has(typeSearch == 2 ? data.name : data.userName )"
          (nzCheckedChange)="onItemChecked(typeSearch == 2 ? data.name : data.userName , $event)"
        ></td>
        <td>{{ typeSearch == 2 ? data.name : data.userName }}</td>
        <td>{{ typeSearch == 1 ? 'USERS' : 'GROUPS USER' }}</td>
      </tr>
      </tbody>
    </nz-table>

    <div class="text-right">

      <button (click)="goBack()" nzSize="large" nz-button nzType="primary" style="
            border-color: #0066B3;
            background-color: white;
          ">
        <img style="padding-right: 10px;" src="assets/imgs/arrow-left-2.svg" alt=""/>
        <span class="button-text-primary" style="color:#0066B3">{{'app.button.back' | i18n}}</span>
      </button>
      <button [disabled]="setOfCheckedId.size === 0" nzSize="large" (click)="attachPolicy()" nz-button nzType="primary"
              style="
            border: none;
          "><img style="margin-top: -4px; margin-right: 10px;" src="assets/imgs/attach.png" alt=""/>{{'app.button.attach-policy' | i18n}}
      </button>

    </div>

  </nz-card>

</nz-content>


