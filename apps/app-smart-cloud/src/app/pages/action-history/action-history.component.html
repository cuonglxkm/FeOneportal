<page-header
  [breadcrumb]="breadcrumb"
  [action]="action"
  [title]="'Lịch sử thao tác'"
>
  <ng-template #breadcrumb>
    <nz-breadcrumb>
      <nz-breadcrumb-item>
        <a [routerLink]="['/']">Home</a>
      </nz-breadcrumb-item>
      <nz-breadcrumb-item>Action History</nz-breadcrumb-item>
    </nz-breadcrumb>
  </ng-template>
  <ng-template #action>
    <div class="alain-custom-action text-right">
      <region-select-dropdown
        (valueChanged)="onRegionChange($event)"
      ></region-select-dropdown>
      <project-select-dropdown
        [regionId]="regionId"
        (valueChanged)="projectChange($event)"
      ></project-select-dropdown>
    </div>
  </ng-template>
</page-header>

<nz-card style="border-radius: 4px">
  <nz-row style="margin-bottom: 20px">
    <nz-col style="width: 100%">
      <nz-range-picker
        style="border-radius: 8px"
        nzSize="large"
        [nzFormat]="dateFormat"
        [(ngModel)]="dateRange"
        (ngModelChange)="onChangeDateRange()"
      />

      <nz-input-group
        style="margin-left: 10px; width: 30%; border-radius: 8px"
        [nzPrefix]="prefixIconSearch"
        nzSize="large"
      >
        <input
          name="name"
          nz-input
          placeholder="Tìm kiếm  theo thao tác, dịch vụ, loại dịch vụ"
          [(ngModel)]="searchParam"
          (keyup.enter)="getData()"
        />
      </nz-input-group>
      <ng-template #prefixIconSearch>
        <img
          src="assets/imgs/search.svg"
          alt=""
          style="cursor: pointer"
          nz-tooltip="Tìm kiếm"
          (click)="doSearch()"
        />
      </ng-template>
    </nz-col>
  </nz-row>
  <nz-table
    #rowSelectionTable
    [nzFrontPagination]="false"
    nzShowPagination
    nzShowSizeChanger
    [nzData]="listOfActionHistory"
    [nzTotal]="total"
    [(nzPageSize)]="pageSize"
    [(nzPageIndex)]="pageNumber"
    (nzPageSizeChange)="getData()"
    (nzPageIndexChange)="getData()"
    [nzScroll]="{ x: '100%', y: '55vh' }"
  >
    <thead>
      <tr>
        <th>ID</th>
        <th>Thao tác</th>
        <th>Loại dịch vụ</th>
        <th>Tên dịch vụ</th>
        <th>Khu vực</th>
        <th>Thông tin</th>
        <th>Ngày tạo tác</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of listOfActionHistory">
        <td>{{ item.eventID }}</td>
        <td>{{ item.eventName }}</td>
        <td>{{ item.resourceType }}</td>
        <td>{{ item.resourceName }}</td>
        <td>{{ item.regionText }}</td>
        <td>{{ item.additionalInfo }}</td>
        <td>{{ item.createdTime | date : 'HH:mm:ss dd/MM/yyyy' }}</td>
      </tr>
    </tbody>
  </nz-table>
</nz-card>
