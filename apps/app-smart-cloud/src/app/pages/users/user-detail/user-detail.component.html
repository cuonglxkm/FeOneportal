<page-header>
  <nz-breadcrumb style="width: 50%; float: left">
    <nz-breadcrumb-item>Home</nz-breadcrumb-item>
    <nz-breadcrumb-item>
      <a [routerLink]="['/app-smart-cloud/users']">Users</a>
    </nz-breadcrumb-item>
    <nz-breadcrumb-item>
      <a [routerLink]="['/app-smart-cloud/users/detail/' + id]">Chi tiết User</a>
    </nz-breadcrumb-item>
  </nz-breadcrumb>
  <div class="text-right">
    <region-select-dropdown
      (valueChanged)="onRegionChange($event)"
    ></region-select-dropdown>
    <project-select-dropdown
      [regionId]="regionId"
      (valueChanged)="onProjectChange($event)"
    ></project-select-dropdown>
  </div>
  <div><h2>Thông tin User</h2></div>
</page-header>

<nz-card
  [nzLoading]="loading"
  [nzBordered]="false"
  nzTitle="Thông tin chính của User"
  *ngIf="user"
>
  <div nz-row>
    <div nz-col nzSpan="12">
      <label style="font-weight: 500"
        >Tên User<span class="text-red">*</span></label
      >
      <div class="nameField" style="margin-bottom: 10px">{{ user.name }}</div>
    </div>
  </div>
  <div nz-row>
    <div nz-col nzSpan="12">
      <label style="font-weight: 500"
        >Email<span class="text-red">*</span></label
      >
      <div class="nameField" style="margin-bottom: 10px">{{ user.email }}</div>
    </div>
  </div>
  <div nz-row>
    <div nz-col nzSpan="12">
      <label style="font-weight: 500"
        >Thời gian khởi tạo<span class="text-red">*</span></label
      >
      <div class="nameField">{{ user.createdTime }}</div>
    </div>
  </div>
</nz-card>

<nz-card [nzBordered]="false" nzTitle="Thông tin bổ sung">
  <nz-tabset>
    <nz-tab nzTitle="Policies">
      <form nz-form>
        <div nz-row [nzGutter]="{ xs: 8, sm: 16, md: 24, lg: 24 }">
          <div
            nz-col
            [nzLg]="6"
            [nzMd]="6"
            [nzSm]="24"
            [nzXl]="6"
            [nzXs]="24"
            [nzXXl]="6"
          >
            <nz-form-item>
              <nz-form-label [nzFor]="">Loại Policy:</nz-form-label>
              <nz-form-control>
                <nz-select
                  [ngModel]="typePolicy"
                  [nzPlaceHolder]="'Tất cả các loại'"
                  [nzShowSearch]="false"
                  (ngModelChange)="changeFilterStatus($event)"
                >
                  <nz-option
                    *ngFor="let i of filterStatus"
                    [nzLabel]="i.text"
                    [nzValue]="i.value"
                  />
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div
            nz-col
            [nzLg]="10"
            [nzMd]="10"
            [nzSm]="24"
            [nzXl]="10"
            [nzXs]="24"
            [nzXXl]="10"
          >
            <nz-form-item>
              <nz-row style="width: 100%">
                <nz-col style="width: 60%">
                  <nz-form-control>
                    <input
                      name="name"
                      nz-input
                      placeholder="Tìm kiếm tên, thời gian tạo ..."
                      [ngModel]="searchParam"
                      (ngModelChange)="changeSearch($event)"
                    />
                  </nz-form-control>
                </nz-col>
                <nz-form-control>
                  <button
                    nz-button
                    [nzType]="'primary'"
                    (click)="getPolicies()"
                  >
                    <i nz-icon nzType="search"></i>
                    Search
                  </button>
                </nz-form-control>
              </nz-row>
            </nz-form-item>
          </div>
          <div
            class="text-right p-0 m-b-0"
            nz-col
            [nzLg]="8"
            [nzMd]="8"
            [nzSm]="24"
            [nzXl]="8"
            [nzXs]="24"
            [nzXXl]="8"
          >
            <button
              class="m-r-8"
              nz-button
              nzType="default"
              style="background-color: white"
              (click)="reloadPolicies()"
            >
              <img
                style="margin-bottom: 4px"
                src="assets/imgs/undo.png"
                alt=""
              />
            </button>
            <button
              class="m-r-8"
              nz-button
              nzType="default"
              style="background-color: #9c9c9c; color: white"
              (click)="deletePolicies()"
            >
              <i nz-icon nzType="delete"></i>
              Xóa
            </button>
            <button
              class="m-r-8"
              class="bg-success border-success"
              nz-button
              nzType="primary"
              (click)="navigateToAddPolicies()"
            >
              <i nz-icon nzType="plus"></i>
              Thêm policies
            </button>
          </div>
        </div>
      </form>
      <div stype="font-weight: 500">
        Policies
      </div>
      <div class="nameField">
        có thể đính kèm tối đa 10 policies 
      </div>
      <ng-container>
        <ng-container>
          <nz-table
            #rowSelectionTable
            nzShowSizeChanger
            [nzFrontPagination]="false"
            [nzData]="listOfpolicies"
            [nzLoading]="loading"
            [nzTotal]="total"
            [(nzPageIndex)]="pageIndex"
            [(nzPageSize)]="pageSize"
            (nzPageIndexChange)="getPolicies()"
            (nzPageSizeChange)="getPolicies()"
          >
            <thead>
              <tr>
                <th style="width: 20px"></th>
                <th>Tên Policy</th>
                <th>Type</th>
                <th>Attached via</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of listOfpolicies">
                <td>
                  <label
                    nz-checkbox
                    [ngModel]="isUseIPv6"
                    [ngModelOptions]="{ standalone: true }"
                  ></label>
                </td>
                <td>{{ item.name }}</td>
                <td>{{ item.type }}</td>
                <td>{{ item.attachedVia }}</td>
              </tr>
            </tbody>
          </nz-table>
        </ng-container>
      </ng-container>
    </nz-tab>
    <nz-tab nzTitle="Groups">
      <form nz-form>
        <div nz-row [nzGutter]="{ xs: 8, sm: 16, md: 24, lg: 24 }">
          <div
            nz-col
            [nzLg]="10"
            [nzMd]="10"
            [nzSm]="24"
            [nzXl]="10"
            [nzXs]="24"
            [nzXXl]="10"
          >
            <nz-form-item style="margin-bottom: 10px">
              <nz-row style="width: 100%">
                <nz-col style="width: 60%">
                  <nz-form-control>
                    <input
                      name="name"
                      nz-input
                      placeholder="Tìm kiếm tên, thời gian tạo ..."
                      [ngModel]="searchParam"
                      (ngModelChange)="changeSearch($event)"
                    />
                  </nz-form-control>
                </nz-col>
                <nz-form-control>
                  <button nz-button [nzType]="'primary'" (click)="getData()">
                    <i nz-icon nzType="search"></i>
                    Search
                  </button>
                </nz-form-control>
              </nz-row>
            </nz-form-item>
          </div>
          <div
            class="text-right p-0 m-b-0"
            nz-col
            [nzLg]="14"
            [nzMd]="14"
            [nzSm]="24"
            [nzXl]="14"
            [nzXs]="24"
            [nzXXl]="14"
          >
            <button
              class="m-r-8"
              nz-button
              nzType="default"
              style="background-color: white"
              (click)="reloadGroupOfUser()"
            >
              <img
                style="margin-bottom: 4px"
                src="assets/imgs/undo.png"
                alt=""
              />
            </button>
            <button
              class="m-r-8"
              nz-button
              nzType="default"
              style="background-color: #9c9c9c; color: white"
              (click)="deleteGroups()"
            >
              <i nz-icon nzType="delete"></i>
              Xóa
            </button>
            <button
              class="m-r-8"
              class="bg-success border-success"
              nz-button
              nzType="primary"
              (click)="navigateToAddToGroups()"
            >
              <i nz-icon nzType="plus"></i>
              Add to Groups
            </button>
          </div>
        </div>
      </form>
      <div stype="font-weight: 500">
        Các Groups mà User đang tham gia
      </div>
      <div class="nameField">
        Một người dùng có thể là thành viên của tối đa 10 nhóm cùng một lúc
      </div>
      <ng-container>
        <ng-container>
          <nz-table
            #rowSelectionTable
            nzShowSizeChanger
            [nzFrontPagination]="false"
            [nzData]="listOfGroups"
            [nzLoading]="loading"
            [nzTotal]="total"
            [(nzPageIndex)]="pageIndex"
            [(nzPageSize)]="pageSize"
            (nzPageIndexChange)="getData()"
            (nzPageSizeChange)="getData()"
          >
            <thead>
              <tr>
                <th style="width: 20px"></th>
                <th>Tên Group</th>
                <th>Số lượng User</th>
                <th>Attached policies</th>
                <th>Thời gian tạo</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of listOfGroups">
                <td>
                  <label
                    nz-checkbox
                    [ngModel]="isUseIPv6"
                    [ngModelOptions]="{ standalone: true }"
                  ></label>
                </td>
                <td>{{ item.name }}</td>
                <td>{{ item.numberUsers }}</td>
                <td>{{ item.attachedPolicies }}</td>
                <td>{{ item.createdTime }}</td>
              </tr>
            </tbody>
          </nz-table>
        </ng-container>
      </ng-container>
    </nz-tab>
  </nz-tabset>
</nz-card>
