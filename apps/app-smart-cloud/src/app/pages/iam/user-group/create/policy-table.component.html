<nz-card>
  <nz-row nzJustify="space-between" nzAlign="middle" style="margin-bottom: 16px">
    <nz-col>
      <div style="font-size: 20px; font-weight: 600">{{ 'app.create-user-groups.policiesConfig' | i18n }} ({{
        'app.create-user-groups.optional' | i18n }}) ({{listOfSelected?.length}}/{{listPolicies?.length}})</div>
    </nz-col>
    <nz-col>
      <nz-space>
        <nz-input-group *nzSpaceItem style="width: 300px;" [nzPrefix]="prefixIconSearch" nzSize="large"
          [(ngModel)]="value" (input)="onInputChange($event.target['value'])">
          <input name="name" nz-input [placeholder]="'app.users.search' | i18n" />
        </nz-input-group>
        <ng-template #prefixIconSearch>
          <img src="assets/imgs/search.svg" alt="" style="cursor: pointer"
            [nz-tooltip]="'app.service.search-text'|i18n" />
        </ng-template>
        <button *nzSpaceItem style="border: none;" nz-button nzSize="large" nz-tooltip
          [nzTooltipTitle]="'app.cluster.refresh'|i18n" nzTooltipPlacement="bottom" (click)="reload()">
          <img style="margin-top: -4px" src="assets/imgs/refresh.svg" alt="" />
        </button>
      </nz-space>
    </nz-col>
  </nz-row>

  <nz-table #rowSelectionTable nzShowSizeChanger [nzFrontPagination]="false" [nzData]="filteredPolicies"
    (nzQueryParams)="onQueryParamsChange($event)" [nzLoading]="loading" [nzTotal]="response?.totalCount"
    [nzPageSize]="response?.pageSize" [nzPageIndex]="response?.currentPage"
    (nzCurrentPageDataChange)="onCurrentPageDataChange($event)">
    <thead>
      <tr>
        <th [nzChecked]="checked" [nzIndeterminate]="indeterminate" nzLabel="Select all" nzWidth="40px"
          (nzCheckedChange)="onAllChecked($event)"></th>
        <th>{{ 'app.create-user.namePolicy' | i18n }}</th>
        <th>{{ 'app.create-user.type' | i18n }}</th>
        <th>{{ 'app.service.description' | i18n }}</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let data of rowSelectionTable.data">
        <tr>
          <td [nzChecked]="setOfCheckedId.has(data?.name)" (nzCheckedChange)="onItemChecked(data?.name, $event)"></td>
          <td [nzExpand]="expandSet.has(data?.name)" (nzExpandChange)="onExpandChange(data?.name, $event)">
            <a [routerLink]="'/app=smart-cloud/policy/detail/' + data?.name">{{ data?.name }}</a>
          </td>
          <td>{{ data?.type }}</td>
          <td>{{ data?.description }}</td>
        </tr>
        <tr [nzExpand]="expandSet.has(data?.name)">
          <div *ngIf="data?.type ==='Portal managed'">
            <div class="json-viewer-bg">
              <ngx-json-viewer [json]="data" style="position: relative;"></ngx-json-viewer>
            </div>
          </div>
          <div *ngIf="data?.type === 'Customer Manager'">
            <nz-row nzAlign="middle" nzJustify="space-between">
              <nz-space [nzSize]="24">
                <div class="json-viewer-bg">
                  <ngx-json-viewer [json]="data" style="position: relative;"></ngx-json-viewer>
                </div>
              </nz-space>
              <nz-row nzAlign="middle" style="margin-bottom: 250px; margin-right: 50px;">
                <button nz-button nzSize="default" style="cursor: pointer;"
                  [routerLink]="'/app-smart-cloud/policy/update/' +  data.name" class="button-cancel">{{
                  'app.button.update' | i18n }}
                </button>
              </nz-row>
            </nz-row>
          </div>
        </tr>
      </ng-container>

    </tbody>
  </nz-table>
</nz-card>