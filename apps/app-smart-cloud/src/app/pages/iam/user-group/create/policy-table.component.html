<nz-card>
  <nz-row nzJustify="space-between" style="margin-bottom: 16px">
    <nz-col>
      <div style="font-size: 20px; font-weight: 600">Thiết lập Policies (Optional) ({{listOfSelected?.length}}/{{listPolicies?.length}})</div>
    </nz-col>
    <nz-col>
      <nz-space>
        <nz-input-group *nzSpaceItem nzSearch [nzPrefix]="prefixIconSearch">
          <input style="width: 300px;" [(ngModel)]="value" (input)="onInputChange($event.target['value'])" type="text" nz-input
                 placeholder="Tìm kếm tên..."/>
        </nz-input-group>
        <ng-template #prefixIconSearch>
          <span nz-icon nzType="search"></span>
        </ng-template>
        <button *nzSpaceItem nz-button nzSize="default" style="cursor: pointer;" (click)="reload()">
          <span nz-icon nzType="reload" nzTheme="outline"></span>
        </button>
      </nz-space>
    </nz-col>
  </nz-row>

    <nz-table
        #rowSelectionTable
        nzShowSizeChanger
        [nzFrontPagination]="false"
        [nzData]="filteredPolicies"
        (nzQueryParams)="onQueryParamsChange($event)"
        [nzLoading]="loading"
        [nzTotal]="response?.totalCount"
        [nzPageSize]="response?.pageSize"
        [nzPageIndex]="response?.currentPage"
        (nzCurrentPageDataChange)="onCurrentPageDataChange($event)">
        <thead>
        <tr>
            <th [nzChecked]="checked"
                [nzIndeterminate]="indeterminate"
                nzLabel="Select all"
                nzWidth="40px"
                (nzCheckedChange)="onAllChecked($event)"></th>
            <th>Tên Policy</th>
            <th>Type</th>
            <th>Mô tả</th>
        </tr>
        </thead>
        <tbody>
        <ng-container *ngFor="let data of rowSelectionTable.data">
            <tr>
                <td
                        [nzChecked]="setOfCheckedId.has(data?.name)"
                        (nzCheckedChange)="onItemChecked(data?.name, $event)"
                ></td>
                <td [nzExpand]="expandSet.has(data?.name)" (nzExpandChange)="onExpandChange(data?.name, $event)">
                    <a [routerLink]="'/app=smart-cloud/policy/detail/' + data?.name">{{ data?.name }}</a>
                </td>
                <td>{{ data?.type }}</td>
                <td>{{ data?.description }}</td>
            </tr>
            <tr [nzExpand]="expandSet.has(data?.name)">
                <div *ngIf="data?.type ==='Portal managed'">
                  <div class="json-viewer-bg">
                    <ngx-json-viewer [json]="data" style="position: relative;"></ngx-json-viewer>
                  </div>
                </div>
                <div *ngIf="data?.type === 'Customer Manager'">
                    <nz-row nzAlign="middle" nzJustify="space-between">
                        <nz-space [nzSize]="24">
                          <div class="json-viewer-bg">
                            <ngx-json-viewer [json]="data" style="position: relative;"></ngx-json-viewer>
                          </div>
                        </nz-space>
                        <nz-row nzAlign="middle" style="margin-bottom: 250px; margin-right: 50px;">
                            <button nz-button
                                    nzSize="default"
                                    style="cursor: pointer;"
                                    [routerLink]="'/app-smart-cloud/policy/update/' +  data.name"
                                    class="button-cancel">Chỉnh sửa
                            </button>
                        </nz-row>
                    </nz-row>
                </div>
            </tr>
        </ng-container>

        </tbody>
    </nz-table>
</nz-card>
