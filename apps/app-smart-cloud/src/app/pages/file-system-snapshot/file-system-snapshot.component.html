<page-header [breadcrumb]="breadcrumb" [action]="action" [title]="'Quản lý File System Snapshot'">
    <ng-template #breadcrumb>
      <nz-breadcrumb>
        <nz-breadcrumb-item>Trang chủ</nz-breadcrumb-item>
        <nz-breadcrumb-item>Dịch vụ hạ tầng</nz-breadcrumb-item>
        <nz-breadcrumb-item>File Storage</nz-breadcrumb-item>
        <nz-breadcrumb-item>Quản lý File System Snapshot</nz-breadcrumb-item>
      </nz-breadcrumb>
    </ng-template>
    <ng-template #action>
      <div class="alain-custom-action text-right">
        <region-select-dropdown (valueChanged)="onRegionChange($event)"></region-select-dropdown>
        <project-select-dropdown [regionId]="region"
                                 (valueChanged)="projectChange($event)"
                                 (userChanged)="projectChange($event)"></project-select-dropdown>
      </div>
    </ng-template>
  </page-header>
  <nz-content>
    <nz-card>
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <span class="text-card-header">Quản lý File System Snapshot</span>
      <nz-row style="gap: 16px">
        <nz-col>
          <nz-input-group [nzPrefix]="prefixIconSearch"
                          nzSize="large"
                          style="width: 300px;">
            <input name="name"
                   nz-input
                   placeholder="Tìm kiếm"
                   [(ngModel)]="value"
                   (input)="onInputChange($event.target['value'])"/>
          </nz-input-group>
          <ng-template #prefixIconSearch>
            <img src="assets/imgs/search.svg" alt="" style="cursor: pointer" nz-tooltip="Tìm kiếm"/>
          </ng-template>
        </nz-col>
        <nz-col>
            <button [routerLink]="['/app-smart-cloud/file-system-snapshot/create']" nz-button nzType="primary" nzSize="large">
                <img style="padding-right: 10px; margin-top: -4px" src="assets/imgs/add-circle.svg" alt=""/>
                <span class="button-text-primary">Tạo mới File System Snapshot</span>
              </button>
        </nz-col>
      </nz-row>
      </div>
      <nz-table #fixedTable
                style="margin-top: 20px;"
                [nzData]="filteredData"
                [nzPageSize]="response?.pageSize"
                (nzPageSizeChange)="onPageSizeChange($event)"
                [nzPageIndex]="response?.currentPage"
                (nzPageIndexChange)="onPageIndexChange($event)"
                [nzTotal]="response?.totalCount"
                [nzFrontPagination]="false"
                [nzLoading]="isLoading">
        <thead>
        <tr>
          <th>STT</th>
          <th>Tên Snapshot</th>
          <th>Dung lượng (GB)</th>
          <th>Trạng thái tác vụ</th>
          <th>Tên File System</th>
          <th>Ngày cấp dịch vụ</th>
          <th nzAlign='center'>Thao tác</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let data of fixedTable.data; index as i">
          <td>{{i+1}}</td>
          <td>
            <a [routerLink]="'/app-smart-cloud/file-system-snapshot/detail/' + data.id">{{data.name}}</a>
          </td>
          <td>{{data.size}}</td>
          <td>{{data.status}}</td>
          <td>{{data.shareName}}</td>
          <td>{{data.createdDate | date: 'dd/MM/yyyy'}}</td>
          <td>
              <div class="d-flex gap-2 justify-content-center">
                <one-portal-edit-file-system-snapshot [region]="region"
              [project]="project" [data]="data" (onOk)="handleOkEditFileSystemSnapShot()" [filesystemsnapshotId]="data.id" />
              <one-portal-delete-file-system-snapshot 
              [region]="region"
              [project]="project" [filesystemsnapshotId]="data.id" 
              [filesystemsnapshotName]="data.name" 
              (onOk)="handleOkDeleteFileSystemSnapShot()"
              />
              </div>
          </td>
        </tr>
        </tbody>
      </nz-table>
    </nz-card>
  </nz-content>
  