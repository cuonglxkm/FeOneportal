<page-header [breadcrumb]="breadcrumb" [title]="'Quản lý S3 Key'">
  <ng-template #breadcrumb>
    <nz-breadcrumb>
      <nz-breadcrumb-item><a [routerLink]="['/']">Trang chủ</a></nz-breadcrumb-item>
      <nz-breadcrumb-item><a [routerLink]="['/app-smart-cloud/s3-key']">S3 Key</a></nz-breadcrumb-item>
    </nz-breadcrumb>
  </ng-template>
</page-header>

<nz-card class="text-label" title="ok">
  <div style="margin-bottom: 20px;" nz-row [nzGutter]="{ xs: 8, sm: 16, md: 24, lg: 24 }">
    <div class="text-left p-0 m-b-0" nz-col [nzLg]="12" [nzMd]="12" [nzSm]="24" [nzXl]="12" [nzXs]="24"
         [nzXXl]="12">
      <span class="text-card-header">Danh sách S3 Key</span>
    </div>
    <div class="text-right p-0 m-b-0" nz-col [nzLg]="12" [nzMd]="12" [nzSm]="24" [nzXl]="12" [nzXs]="24"
         [nzXXl]="12">
      <nz-input-group style="margin-right: 8px; width: 40%;border-radius: 8px" [nzPrefix]="suffixIconSearch"
                      nzSize="large">
        <input #searchBox (keyup.enter)="search(searchBox.value)" name="name" nz-input
               placeholder="Tìm kiếm theo tên User"/>
      </nz-input-group>
      <ng-template #suffixIconSearch>
        <img src="assets/imgs/search.svg" alt="" style="cursor: pointer" nz-tooltip="Tìm kiếm"
             (click)="search(searchBox.value)"/>
      </ng-template>
      <button nz-button nzType="primary" (click)="createS3Key()" nzSize="large">
        <img style="padding-right: 10px;" src="assets/imgs/add-circle.svg" alt=""/>
        <span class="button-text-primary">Tạo mới S3 Key</span>
      </button>
    </div>
  </div>
  <!-- Bảng-->
  <nz-table #rowSelectionTable nzShowPagination nzShowSizeChanger [nzData]="listOfS3Key"
            [nzTotal]="total" [nzPageSize]="size" (nzPageSizeChange)="onPageSizeChange($event)"
            (nzPageIndexChange)="onPageIndexChange($event)" [nzLoading]="loading">
    <thead>
    <tr>
      <th>STT</th>
      <th>AccessKey</th>
      <th>SecretKey</th>
      <th>User</th>
      <th>Thao tác</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let item of listOfS3Key">
      <td>{{count}}</td>
      <td>
        <!--        <nz-row nzJustify="space-between">-->
        <!--         -->
        <!--        </nz-row>-->
        {{item.accessKey}}
        <span style="color: #0066B3; margin-left: 10px;" nz-icon nzType="copy" nzTheme="outline"
              (click)="copyText(item.accessKey)"></span>
      </td>
      <td>
        {{item.secretKey}}
        <span style="color: #0066B3; margin-left: 10px;" nz-icon nzType="copy" nzTheme="outline"
              (click)="copyText(item.secretKey)"></span>
      </td>
      <td>{{item.userId}}</td>
      <td>
        <div>
          <!---Gỡ------>
          <span style="color: #0066B3; margin-right: 10px;"
                nz-tooltip
                nzTooltipTitle="Nhân tạo lại" nzTooltipPlacement="bottom"
                nz-icon nzType="reload" nzTheme="outline" (click)="openModelDuplicate(item.accessKey)"></span>
          <!----Xóa---->
          <span style="color: #0066B3"
                nz-tooltip
                nzTooltipTitle="Xóa" nzTooltipPlacement="bottom"
                nz-icon nzType="delete" nzTheme="outline" (click)="openModelDelete(item.accessKey)"></span>
        </div>
      </td>
    </tr>
    </tbody>
  </nz-table>
</nz-card>

<!--Tạo mới-->
<nz-modal [(nzVisible)]="isVisibleCreate" nzTitle="Tạo mới S3 Key" (nzOnCancel)="isVisibleCreate = false"
          (nzOnOk)="createSecretKey()" nzOkText="Xác nhận"
          nzCancelText="Hủy">
  <ng-container *nzModalContent>
    <div class="text-label">Chọn User/SubUser (<span class="text-red">*</span>)</div>
    <nz-select nzSize="large" [nzLoading]="loadingDropdown" [nzDisabled]="disableDropdown"
               style="width: 90%; margin-left: -1px;border-radius: 10px;"
               nzPlaceHolder="--Chọn IP kết nôi--"
               [ngModel]="userCreate" (nzOpenChange)="changeUser($event)">
      <nz-option *ngFor="let i of listUser" [nzLabel]="i.subUserId"
                 [nzValue]="i.subUserId"/>
    </nz-select>
  </ng-container>
</nz-modal>

<!--Xóa-->
<nz-modal [(nzVisible)]="isVisibleDelete" nzTitle="Xác nhận xóa S3 Key" (nzOnCancel)="isVisibleDelete = false"
          (nzOnOk)="deleteSecretKey()" nzOkText="Xác nhận"
          nzCancelText="Hủy">
  <ng-container *nzModalContent>
    <nz-alert
      nzType="warning"
      nzDescription="Bạn đang thực hiện xóa SecretKey."
      nzShowIcon
      style="margin-bottom: 10px;"
    ></nz-alert>
    <b>Quý khách chắc chắn muốn thực hiện xóa SecretKey?</b>
  </ng-container>
</nz-modal>

<!--Nhân tạo-->
<nz-modal [(nzVisible)]="isVisibleUplicate" nzTitle="Xác nhận xóa S3 Key" (nzOnCancel)="isVisibleUplicate = false"
          (nzOnOk)="duplicateSecretKey()" nzOkText="Xác nhận"
          nzCancelText="Hủy">
  <ng-container *nzModalContent>
    <nz-alert
      nzType="warning"
      nzDescription="Bạn đang thực hiện tạo lại SecretKey."
      nzShowIcon
      style="margin-bottom: 10px;"
    ></nz-alert>
    <b>Quý khách chắc chắn muốn thực hiệntại lại SecretKey?</b>
  </ng-container>
</nz-modal>

