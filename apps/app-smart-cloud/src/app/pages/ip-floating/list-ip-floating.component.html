<page-header [breadcrumb]="breadcrumb" [action]="action" [title]="('kafka.detail.manage' |i18n)+ ' IP Floating'">
  <ng-template #breadcrumb>
    <nz-breadcrumb>
      <nz-breadcrumb-item><a [routerLink]="['/']">{{ 'app.breadcrumb.home' | i18n }}</a></nz-breadcrumb-item>
      <nz-breadcrumb-item>Networks</nz-breadcrumb-item>
      <nz-breadcrumb-item><a [routerLink]="['/app-smart-cloud/networks/ip-floating/list']">IP Floating</a></nz-breadcrumb-item>
    </nz-breadcrumb>
  </ng-template>
  <ng-template #action>
    <div class="alain-custom-action text-right">
      <share-users-combobox></share-users-combobox>
      <region-select-dropdown (valueChanged)="onRegionChange($event)"></region-select-dropdown>
      <project-select-dropdown [regionId]="region"
                               (valueChanged)="projectChange($event)"
                               (userChanged)="projectChange($event)"></project-select-dropdown>
    </div>
  </ng-template>
</page-header>
<nz-content>
  <nz-card>
    <span class="text-card-header">{{'ip.floating.label.list.address' | i18n}} IP Floating</span>
    <nz-row nzJustify="space-between" style="margin-top: 20px;">
      <nz-col nzSpan="16">
        <nz-input-group [nzPrefix]="prefixIconSearch"
                        nzSize="large"
                        style="width: 300px;">
          <input name="name"
                 nz-input
                 placeholder="{{'app.button.search' | i18n}}"
                 [(ngModel)]="value"
                 (input)="onInputChange($event.target['value'])"/>
        </nz-input-group>
        <ng-template #prefixIconSearch>
          <img src="assets/imgs/search.svg" alt="" style="cursor: pointer" nz-tooltip="{{'app.button.search' | i18n}}"/>
        </ng-template>
      </nz-col>
      <nz-col nzSpan="8" style="flex:none;">
        <one-portal-create-ip-floating [region]="region" [project]="project" [projectType]="projectType" (onOk)="handleOkCreateIpFloating()" />
      </nz-col>
    </nz-row>
    <nz-table #fixedTable
              style="margin-top: 20px;"
              [nzData]="response?.records"
              [nzPageSize]="response?.pageSize"
              (nzPageSizeChange)="onPageSizeChange($event)"
              [nzPageIndex]="response?.currentPage"
              (nzPageIndexChange)="onPageIndexChange($event)"
              [nzTotal]="response?.totalCount"
              [nzFrontPagination]="false"
              [nzLoading]="isLoading">
      <thead>
      <tr>
        <th>{{'ip.floating.alert.ip.floating.address' | i18n}}</th>
        <th>Mapped Fixed IP Address</th>
        <th>Network</th>
        <th>{{'app.create-user.type' | i18n}}</th>
        <th>{{'app.action-history.operation' | i18n}}</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let data of fixedTable.data">
<!--        <td>{{data.ipAddress}}</td>-->
        <td>
          <span *ngIf="data.ipAddress != null || data.ipAddress != ''">{{data.ipAddress}}</span>
          <span *ngIf="data.ipAddress == null || data.ipAddress == ''">{{data.iPv6Address}}</span>
        </td>
        <td>{{data.fixedIpAddress}}</td>
        <td>{{data.network}}</td>
        <td>{{data.typeIP}}</td>
        <td>
          <div>
            <one-portal-attach-ip-floating [region]="region"
                                           [project]="project"
                                           [idIpFloating]="data.id"
                                           (onOk)="handleOkAttachIpFloating()"/>

            <one-portal-detach-ip-floating [region]="region"
                                           [project]="project"
                                           [idIpFloating]="data.id"
                                           (onOk)="handleOkDetachIpFloating()" />
            <img *ngIf="projectType == 0" style="padding-right: 10px;" src="assets/imgs/calendar-tick.svg"
                 nz-tooltip nzTooltipTitle="{{'app.extend' | i18n}} IP Floating" nzTooltipPlacement="bottom"
                 [routerLink]="['/app-smart-cloud/networks/ip-floating-normal/' + data.id + '/extend']"/>
            <div *ngIf="data.typeIP.includes('IP WAN')">
              <div *ngIf="data.ipAddress != null || data.ipAddress != ''">
                <one-portal-delete-ip-floating [region]="region"
                                               [project]="project"
                                               [idIpFloating]="data.id"
                                               [ip]="data.ipAddress"
                                               (onOk)="handleOkDeleteIpFloating()" />
              </div>
              <div *ngIf="data.ipAddress == null || data.ipAddress == ''">
                <one-portal-delete-ip-floating [region]="region"
                                               [project]="project"
                                               [idIpFloating]="data.id"
                                               [ip]="data.iPv6Address"
                                               (onOk)="handleOkDeleteIpFloating()" />
              </div>
            </div>
          </div>
        </td>
      </tr>
      </tbody>
    </nz-table>
  </nz-card>
</nz-content>
