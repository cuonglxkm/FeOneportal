<page-header [breadcrumb]="breadcrumb"
             [title]="title">
  <ng-template #breadcrumb>
    <nz-breadcrumb>
      <nz-breadcrumb-item>
        <a [routerLink]="['/']">Home</a>
      </nz-breadcrumb-item>
      <nz-breadcrumb-item>
        <a [routerLink]="['/']">Dịch vụ</a>
      </nz-breadcrumb-item>
      <nz-breadcrumb-item>
        <a [routerLink]="'/app-smart-cloud/volumes'">
          Volume
        </a></nz-breadcrumb-item>
    </nz-breadcrumb>
    <div class="alain-custom-action text-right">
      <region-select-dropdown (valueChanged)="regionChanged($event)"></region-select-dropdown>
      <project-select-dropdown (valueChanged)="projectChanged($event)"
                               [regionId]="region"></project-select-dropdown>
    </div>
  </ng-template>
  <ng-template #title>
          <span nz-icon
                nzType="arrow-left"
                nzTheme="outline"
                [routerLink]="'/app-smart-cloud/volume/detail/' + this.volumeId"
                style="margin-right: 10px;"></span>
    Chỉnh sửa Volume
  </ng-template>
</page-header>
<nz-content>
  <form nz-form [formGroup]="validateForm" (ngSubmit)="showModalConfirmEdit()" nzLayout="vertical">
    <nz-card nzTitle="Thông tin Volume">
      <nz-form-item>
        <nz-form-label nzFor="name">
          <div class="label">
            <span>Tên Volume</span>
            <span style="color: rgba(252, 16, 16, 1); "> *</span>
          </div>
        </nz-form-label>
        <nz-form-control>
          <input nz-input formControlName="name" value="{{volumeInfo?.name}}" [maxlength]="70"/>
          <ng-template #nameErrorTpl let-control>
            <ng-container *ngIf="control.hasError('required')">Vui lòng nhập tên Volume</ng-container>
            <ng-container *ngIf="control.hasError('pattern')">Vui lòng chỉ nhập kí tự là chữ hoặc số
            </ng-container>
            <ng-container *ngIf="control.haassError('duplicateName')">Tên Volume này đã được sử dụng, vui
              lòng chọn tên khác
            </ng-container>
          </ng-template>
        </nz-form-control>
      </nz-form-item>
            <nz-radio-group [(ngModel)]="selectedValueRadio"
                            (ngModelChange)="changeVolumeType($event)"
                            formControlName="radio"
                            [nzDisabled]="true">
              <div style="display: flex;">
                <div nz-radio nzValue="hdd"
                     [ngStyle]="{'background-color': selectedValueRadio === 'hdd' ? '#e6f7ff' : '#fcfcfc'}"
                     style="width: 50%; height: 80px; padding: 10px;border: thin; border-radius: 5px;">
                  HDD
                  <br>
                  Additional description and information about copywriting.
                </div>
                <div nz-radio nzValue="ssd"
                     [ngStyle]="{'background-color': selectedValueRadio === 'ssd' ? '#e6f7ff' : '#fcfcfc'}"
                     style="width: 50%; height: 80px; padding: 10px;border: thin; border-radius: 5px;">
                  SSD
                  <br>
                  Additional description and information about copywriting.
                </div>
              </div>
            </nz-radio-group>
<!--      <div style="display: flex;">-->
<!--        <label nz-radio-->
<!--               nzValue="hdd"-->
<!--               [ngStyle]="{'background-color': volumeInfo?.volumeType === 'hdd' ? '#e6f7ff' : '#fcfcfc'}"-->
<!--               style="width: 50%; height: 80px; padding: 10px;border: thin; border-radius: 5px;"-->
<!--               [ngModel]="volumeInfo?.volumeType === 'hdd'"-->
<!--               [nzDisabled]="true">HDD-->
<!--        <br>Additional description and information about copywriting.-->
<!--        </label>-->
<!--        <label nz-radio-->
<!--               nzValue="ssd"-->
<!--               [ngModel]="volumeInfo?.volumeType === 'ssd' "-->
<!--               [ngStyle]="{'background-color': volumeInfo?.volumeType === 'ssd' ? '#e6f7ff' : '#fcfcfc'}"-->
<!--                         style="width: 50%; height: 80px; padding: 10px;border: thin; border-radius: 5px;"-->
<!--               [nzDisabled]="true">SSD-->
<!--        <br>Additional description and information about copywriting.</label>-->
<!--          </div>-->
          <nz-form-item>
            <nz-table [nzTemplateMode]=true style="margin-top: 15px;">
              <thead>
              <tr>
                <th>Dung lượng(GB)</th>
                <th>IOPS</th>
                <th>Giá theo tháng(VNĐ)</th>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td>
                  <nz-input-number formControlName="storage"
                                   (ngModelChange)="changeValueInput()"
                                   [nzMin]="oldSize" [nzStep]="1"></nz-input-number>
                </td>
                <td>{{iops}}</td>
                <td>{{unitPrice}}</td>
              </tr>
              </tbody>
            </nz-table>
          </nz-form-item>
          <div>
            <label nz-checkbox [nzChecked]="volumeInfo?.isEncryption" nzDisabled>Mã hóa Volume</label>
          </div>
          <div style="margin-top: 15px;">
            <label nz-checkbox [nzChecked]="volumeInfo?.isMultiAttach" nzDisabled>Gắn nhiều máy ảo</label>
          </div>
          <nz-form-item>
            <nz-form-label nzFor="name">
              <div class="label" style="margin-top: 15px;">
                <span>Chọn máy ảo</span>
                <span style="color: rgba(252, 16, 16, 1); "> *</span>
              </div>
            </nz-form-label>
            <nz-form-control>
              <input nz-input value="{{instance?.name}}" [disabled]="true"/>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label nzFor="description">
              <div class="label">
                <span>Mô tả</span>
              </div>
            </nz-form-label>
            <nz-form-control nzDisableAutoTips [nzErrorTip]="descriptionErrorTpl">
                        <textarea nz-input formControlName="description" id="description" [maxLength]="700"
                                  [nzAutosize]="{ minRows: 3, maxRows: 5 }"></textarea>
              <ng-template #descriptionErrorTpl let-control>
                <ng-container *ngIf="control.hasError('maxlength')">Cho phép nhập tối đa 700 kí tự</ng-container>
              </ng-template>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label>
              <div class="label">
                <span>Thời gian sử dụng (Tháng)</span>
                <span style="color: rgba(252, 16, 16, 1); "> *</span>
              </div>
            </nz-form-label>
            <nz-form-control>
              <input nz-input value="{{expiryTime}}" disabled="true"/>
            </nz-form-control>
          </nz-form-item>
          <div class="label">
            <span>Thời gian bắt đầu sử dụng:</span> {{ volumeInfo?.creationDate | date:'dd/MM/yyyy' }}
          </div>
        </nz-card>
        <nz-card nzTitle="Thành tiền" [nzExtra]="extraTemplate">
          <nz-table>
            <tr>
              <td>Chi phí volume (1 tháng)</td>
              <td nzAlign="right" *ngIf="orderItem == undefined">0 VND</td>
              <td nzAlign="right"
                  *ngIf="orderItem != undefined">{{orderItem?.totalAmount?.amount}} {{orderItem?.totalAmount?.currency}}</td>
            </tr>
            <tr>
              <td>Thành tiền (Đã bao gồm 10% VAT)</td>
              <td nzAlign="right" *ngIf="orderItem == undefined">0 VND</td>
              <td nzAlign="right"
                  *ngIf="orderItem != undefined">{{orderItem?.totalPayment?.amount}} {{orderItem?.totalPayment?.currency}}</td>
            </tr>
          </nz-table>
          <nz-form-item nzAlign="bottom" nzJustify="end" style="margin-top: 24px; margin-bottom: 0;">
            <nz-space nzSize="middle">
              <button *nzSpaceItem nz-button nzType="default" class="button-back" (click)="goBack()">Quay lại</button>
              <nz-form-control *nzSpaceItem>
                <button nz-button
                        nzType="primary"
                        [nzLoading]="isLoading"
                        class="button-create"
                        [disabled]="!validateForm.valid"
                >Chỉnh sửa
                </button>
                <nz-modal [(nzVisible)]="isVisibleConfirmEdit" nzTitle="Xác nhận thông tin thay đổi"
                          (nzOnCancel)="handleCancel()" nzCentered>
                  <div *nzModalTitle>
                    <p class="text-h5"><b>Xác nhận thông tin thay đổi</b></p>
                  </div>
                  <div *nzModalContent>

                    <p class="text-p" style="margin-top: 5px">Quý khách chắn chắn muốn thực hiện thay đổi thông tin Volume?</p>
                  </div>
                  <div *nzModalFooter>
                    <button nz-button nzType="default" (click)="handleCancel()" class="button-cancel">Hủy
                    </button>
                    <button nz-button nzType="primary" (click)="handleOk()"
                            [nzLoading]="isLoading"
                            class="button-ok">Đồng ý
                    </button>
                  </div>
                </nz-modal>
              </nz-form-control>
            </nz-space>
          </nz-form-item>
        </nz-card>
        <ng-template #extraTemplate>
          <a>More</a>
        </ng-template>
      </form>

    </nz-content>

