<page-header [content]="content"
             [breadcrumb]="breadcrumb"
             [action]="action"
             [title]="'Danh sách Volume'">
  <ng-template #breadcrumb>
    <nz-breadcrumb>
      <nz-breadcrumb-item>
        <a [routerLink]="['/']">Home</a>
      </nz-breadcrumb-item>
      <nz-breadcrumb-item>
        <a [routerLink]="['/']">Dịch vụ</a>
      </nz-breadcrumb-item>
      <nz-breadcrumb-item>
        <a [routerLink]="'/app-smart-cloud/volumes'">
          Volume
        </a></nz-breadcrumb-item>
    </nz-breadcrumb>
  </ng-template>
  <ng-template #action>
    <div class="alain-custom-action text-right">
      <region-select-dropdown (valueChanged)="regionChanged($event)"></region-select-dropdown>
      <project-select-dropdown (valueChanged)="projectChanged($event)"
                               [regionId]="region"></project-select-dropdown>
    </div>
  </ng-template>
  <ng-template class="row" #content>
    <nz-row>
      <nz-col style="width: 85%">
        <nz-form-label [nzFor]="'volumeStatus'">Trạng thái Volume</nz-form-label>
        <nz-select [(ngModel)]="selectedValue"
                   (ngModelChange)="onChange($event)"
                   style="width: 150px;"
                   nzPlaceHolder="Tất cả trạng thái"
                   nzTooltipTitle="Tìm kiếm theo trạng thái"
                   nzTooltipPlacement="bottom"
                   nz-tooltip>
          <nz-option *ngFor="let item of options" [nzValue]="item.value" [nzLabel]="item.label"></nz-option>
        </nz-select>
        <nz-input-group nzSearch nzSize="default" [nzAddOnAfter]="suffixButton">
          <input type="text" [(ngModel)]="value" (input)="onInputChange($event.target['value'])" nz-input
                 placeholder="Tìm kiếm tên Volume"
                 style="width: 300px; margin-left: 30px;"/>
        </nz-input-group>
        <ng-template #suffixButton>
          <button nz-button nzTooltipTitle="Tìm kiếm tên" nzTooltipPlacement="bottom" nz-tooltip nzType="primary"
                  nzSearch
                  (click)="getListVolumes()">
            <span nz-icon nzType="search" nzTheme="outline"></span>
            Search
          </button>
        </ng-template>
      </nz-col>
      <nz-col>
        <button class="bg-success border-success"
                nz-button
                nzType="primary"
                (click)="navigateToCreateVolume()">
          <span nz-icon nzType="plus" nzTheme="outline"></span>
          Tạo mới
        </button>
      </nz-col>
    </nz-row>
  </ng-template>
</page-header>

<nz-content>
  <div class="search-volume" *ngIf="!isBlankVolume; else elsePage">
    <nz-table #fixedTable
              [nzScroll]="{ x: '1000px', y: '450px' }"
              [nzData]="response?.records"
              nzShowSizeChanger
              [nzFrontPagination]="false"
              [nzLoading]="isLoading"
              [nzPageSize]="response?.pageSize"
              [nzPageIndex]="response?.currentPage"
              [nzTotal]="response?.totalCount"
              (nzPageSizeChange)="onPageSizeChange($event)"
              (nzPageIndexChange)="onPageIndexChange($event)">
      <thead>
      <tr>
        <th nzLeft>Tên Volume</th>
        <th nzBreakWord>Dung lượng (GB)</th>
        <th nzBreakWord>IOPS</th>
        <th nzBreakWord>Trạng thái Volume</th>
        <th nzBreakWord>Trạng thái tác vụ</th>
        <th nzBreakWord>Máy ảo</th>
        <th nzBreakWord>Thao tác</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let data of fixedTable.data">
        <td nzLeft><a [routerLink]="'/app-smart-cloud/volume/detail/' + data.id">{{data.name}}</a></td>
        <td nzBreakWord>{{data.sizeInGB}}</td>
        <td nzBreakWord>
          <div *ngIf="data.iops == null">200</div>
          <div *ngIf="data.iops != null">{{data.iops}}</div>
        </td>
        <td nzBreakWord>
          <div class="status" [ngSwitch]="data.status">
            <span class="available" *ngSwitchCase="'KHOITAO'">
                                            Đang hoạt động
                                          </span>
            <span class="available" *ngSwitchCase="'CREATING'">
                                            Đang khởi tạo
                                          </span>
            <span class="suspended" *ngSwitchCase="'SUSPENDED'">
                                            Tạm dừng
                                          </span>
            <span class="suspended" *ngSwitchCase="'ERROR'">
                                            Lỗi
                                          </span>
            <span class="suspended" *ngSwitchCase="'DELETING'">
                                            Đang xóa
                                          </span>
          </div>
        </td>
        <td nzBreakWord>{{ data.serviceStatus }}</td>
        <td nzBreakWord>
          <div *ngIf="data.instanceName == null">-</div>
          <div *ngIf="data.instanceName != null">{{data.instanceName}}</div>
        </td>
        <td nzBreakWord>
          <nz-select nzSize="default"
                     class="custom-background"
                     [nzPlaceHolder]="'Gắn Volume'"
                     [nzOptions]="optionVolumeAdd"
                     style="width: 150px;"
                     [ngModel]="selectedOptionAction"
                     (ngModelChange)="onSelectionChange($event , data)">
          </nz-select>
        </td>
      </tr>
      </tbody>
    </nz-table>
  </div>
</nz-content>

<ng-template #elsePage>
  <nz-card>
    <result>
      <img nz-image style="height: 100%; width: 100%;" nzSrc="assets/imgs/blank_volume.png" alt=""/>
      <button nz-button [nzType]="'primary'" (click)="navigateToCreateVolume()">
        Khởi tạo ngay
      </button>
    </result>
  </nz-card>
</ng-template>
