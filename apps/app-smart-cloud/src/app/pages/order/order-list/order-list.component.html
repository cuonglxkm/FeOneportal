<page-header [breadcrumb]="breadcrumb" [action]="action" [title]="'Danh sách đơn hàng'">
  <ng-template #breadcrumb>
    <nz-breadcrumb>
      <nz-breadcrumb-item> <a [routerLink]="['/']">Trang chủ</a></nz-breadcrumb-item>
      <nz-breadcrumb-item> <a [routerLink]="['/app-smart-cloud/order/list']">Đơn hàng</a></nz-breadcrumb-item>
    </nz-breadcrumb>
  </ng-template>
  <ng-template #action>
    <div class="alain-custom-action text-right">
      <region-select-dropdown (valueChanged)="regionChanged($event)"></region-select-dropdown>
      <project-select-dropdown [regionId]="region" (valueChanged)="projectChanged($event)" (userChanged)="projectChanged($event)"></project-select-dropdown>
    </div>
  </ng-template>
</page-header>
  <nz-card>
    <div>
      <nz-row nzAlign="middle">
        <nz-space [nzSize]="24">
          <div *nzSpaceItem>
            <nz-select [(ngModel)]="searchStatus"
                       style="width: 160px;"
                       (ngModelChange)="onChange($event)"
                       nzPlaceHolder="Trạng thái">
              <nz-option *ngFor="let item of status" [nzValue]="item.value" [nzLabel]="item.label"></nz-option>
            </nz-select>
          </div>
        </nz-space>
        <nz-range-picker [nzPlaceHolder]="['Từ ngày', 'Đến ngày']" style="margin-left: 10px;" [(ngModel)]="date"
                         (ngModelChange)="onChanggeDate($event)"></nz-range-picker>
        <div style="width: 300px; margin-left: 10px;">
            <nz-input-group nzSearch [nzPrefix]="prefixIconSearch">
              <input style="width: 380px" [(ngModel)]="value" (input)="onInputChange($event.target['value'])"
                     type="text" nz-input
                     placeholder="Tìm kiếm mã đơn hàng"/>
            </nz-input-group>
            <ng-template #prefixIconSearch>
              <img src="assets/imgs/search.svg" alt="" style="cursor: pointer" nz-tooltip="Tìm kiếm"/>
            </ng-template>
        </div>
      </nz-row>
    </div>

    <nz-table
      style="margin-top: 2%;"
      class="table-data"
      #rowSelectionTable
      [nzData]="listOfData"
      nzShowSizeChanger
      [nzFrontPagination]="false"
      [nzTotal]="totalData"
      [nzPageSize]="pageSize"
      [nzPageIndex]="currentPage"
      [nzLoading]="isLoadingEntities"
      (nzQueryParams)="onQueryParamsChange($event)"
    >
      <thead>
      <tr>
        <th>STT</th>
        <th>Mã đơn hàng</th>
        <th>Dịch vụ</th>
        <th>Thời gian đặt hàng</th>
        <th>Trạng thái</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let data of rowSelectionTable.data; let i  = index">
        <td>{{ i + 1 }}</td>
        <td><a (click)="navigateToDetail(data.id)">{{ data.orderCode }}</a></td>
        <td>{{ data.note }}</td>
        <td>{{ data.orderDate | date: 'HH:mm:ss dd/MM/YYYY' }}</td>
        <td [ngStyle]="{'color': data.statusCode === 'Cancelled' ? 'red' : (data.statusCode === 'Completed' ? 'green' : '')}">{{ data.statusCode === 'Cancelled' ? 'Đã hủy' : (data.statusCode === 'Completed' ? 'Thành công' : data.statusCode === 'Paid' ? 'Đã thanh toán' : 'Mới tạo') }}</td>
      </tr>
      </tbody>
    </nz-table>

  </nz-card>
