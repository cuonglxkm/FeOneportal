<page-header>
  <nz-breadcrumb style="float: left">
    <nz-breadcrumb-item>
      <a [routerLink]="['/']">Home</a>
    </nz-breadcrumb-item>
    <nz-breadcrumb-item>
      <a [routerLink]="['/app-smart-cloud/instances']">Quản lý máy ảo</a>
    </nz-breadcrumb-item>
    <nz-breadcrumb-item>
      <a
        [routerLink]="[
          '/app-smart-cloud/instances/instances-detail/' + this.id
        ]"
        >Chi tiết máy ảo</a
      >
    </nz-breadcrumb-item>
    <nz-breadcrumb-item> Gia hạn máy ảo </nz-breadcrumb-item>
  </nz-breadcrumb>
  <div class="text-right">
    <region-select-dropdown [isDetail]="true"></region-select-dropdown>
    <project-select-dropdown
      [isDetail]="true"
      [regionId]="regionId"
    ></project-select-dropdown>
  </div>
  <div>
    <nz-row style="margin-bottom: -10px">
      <h1 style="width: 50%; font-size: 20px">Gia hạn máy ảo</h1>
      <div class="text-right non-pointer" style="width: 50%">
        <button nz-button [nzType]="'primary'" (click)="navigateToEdit()">
          <i nz-icon nzType="edit"></i>
          <span>Chỉnh sửa</span>
        </button>
        <one-portal-instances-btn [instancesId]="id" style="margin-left: 8px">
        </one-portal-instances-btn>
      </div>
    </nz-row>
  </div>
</page-header>

<nz-card
  [nzBordered]="false"
  nzTitle="Thông tin máy ảo"
  [nzLoading]="loading"
  *ngIf="instancesModel"
>
  <nz-row class="customRow">
    <div nz-col nzSpan="12">
      <nz-row style="height: 50px">
        <span class="customSpan" style="width: 40%">Tên máy ảo:</span>
        <span class="fw-600 customSpan">{{ instancesModel.name || '' }}</span>
      </nz-row>
      <nz-row style="height: 50px; background-color: #f2f2f2">
        <span class="customSpan" style="width: 40%">Gói cấu hình:</span>
        <span class="fw-600 customSpan">{{
          instancesModel.flavorName | slice : 3
        }}</span>
      </nz-row>
      <nz-row style="height: 50px">
        <span class="customSpan" style="width: 40%">Trạng thái:</span>
        <span
          *ngIf="instancesModel.status == 'KHOITAO'"
          class="fw-600 customSpan"
          style="color: #52c41a"
          >KHỞI TẠO</span
        >
        <span
          *ngIf="instancesModel.status == 'ACTIVE'"
          class="fw-600 customSpan"
          style="color: #52c41a"
          >ACTIVE</span
        >
      </nz-row>
      <nz-row style="height: 50px; background-color: #f2f2f2">
        <span class="customSpan" style="width: 40%"
          >Băng thông trong nước:</span
        >
        <span class="fw-600 customSpan"
          >{{ instancesModel.bttn || '' }}{{ ' Mbps' }}</span
        >
      </nz-row>
      <nz-row style="height: 50px">
        <span class="customSpan" style="width: 40%">Băng thông quốc tế:</span>
        <span class="fw-600 customSpan"
          >{{ instancesModel.btqt }}{{ ' Mbps' }}</span
        >
      </nz-row>
    </div>
    <div nz-col nzSpan="12">
      <nz-row style="height: 50px">
        <span class="customSpan1" style="width: 40%">Hệ điều hành:</span>
        <span class="fw-600 customSpan1"
          >{{ instancesModel.imageName }}
          <a
            class="text-blue"
            (click)="navigateToChangeImage()"
            style="margin-left: 15px"
          >
            <img src="assets/imgs/undo.png" alt="" /><span
              style="margin-left: 15px"
              >Thay đổi</span
            ></a
          ></span
        >
      </nz-row>
      <nz-row style="height: 50px; background-color: #f2f2f2">
        <span class="customSpan1" style="width: 40%">Truy cập và bảo mật:</span>
        <span
          class="fw-600 customSpan1"
          *ngFor="let item of listSecurityGroupModel; let first = first"
          >{{ !first ? ', ' : '' }}{{ item.name }}
        </span>
      </nz-row>
      <nz-row style="height: 50px">
        <span class="customSpan1" style="width: 40%">IP Public:</span>
        <span class="fw-600 customSpan1">{{ listIPStr }}</span>
      </nz-row>
      <nz-row style="height: 50px; background-color: #f2f2f2">
        <span class="customSpan1" style="width: 40%">IP LAN:</span>
        <span class="fw-600 customSpan1">{{ instancesModel.ipPrivate }}</span>
      </nz-row>
    </div>
  </nz-row>
</nz-card>

<nz-card
  [nzBordered]="false"
  nzTitle="Chu kỳ thanh toán"
  [nzLoading]="loading"
  *ngIf="instancesModel"
>
  <nz-row>
    <div nz-col nzSpan="8">
      <nz-row style="height: 50px">
        <span class="customSpan">Ngày cấp dịch vụ:</span>
        <span class="fw-600" style="margin-left: 3px; margin-top: 2%;">{{
          instancesModel.createdDate | date : 'dd/MM/yyyy'
        }}</span>
      </nz-row>
    </div>
    <div nz-col nzSpan="8">
      <nz-row style="height: 50px">
        <span class="customSpan">Ngày hết hạn:</span>
        <span class="fw-600" style="margin-left: 3px; margin-top: 2%;">
          {{ instancesModel.expiredDate | date : 'dd/MM/yyyy' }}</span
        >
      </nz-row>
    </div>
  </nz-row>
  <nz-row style="margin-top: 20px; margin-bottom: -25px" nzGutter="16">
    <nz-col nzLg="24" nzMd="12" nzSm="24">
      <nz-form-item style="margin-bottom: 5px">
        <nz-form-label
          >Chọn chu kỳ thanh toán (Tháng)
          <span class="text-red">*</span></nz-form-label
        >
        <nz-form-control>
          <nz-row>
            <nz-input-number
              style="width: 50%"
              [nzMin]="0"
              [nzMax]="100"
              [nzStep]="1"
              [(ngModel)]="numberMonth"
              (ngModelChange)="onChangeTime($event)"
              [ngModelOptions]="{ standalone: true }"
            ></nz-input-number>
            <div class="text-red" style="margin-left: 20px">
              Ngày hết hạn dự kiến: {{ newExpiredDate | date : 'dd/MM/yyyy' }}
            </div>
          </nz-row>
        </nz-form-control>
      </nz-form-item>
    </nz-col>
  </nz-row>
</nz-card>

<nz-card nzTitle="Thành tiền">
  <div>
    <nz-table>
      <tr>
        <td>
          Chi phí máy ảo (<span>{{ numberMonth }}</span> tháng)
        </td>
        <td class="float-right">{{ totalAmount }} VNĐ</td>
      </tr>
      <tr>
        <td>Thành tiền ( Đã bao gồm 10% VAT)</td>
        <td class="float-right">{{ totalincludesVAT }} VNĐ</td>
      </tr>
    </nz-table>
    <div style="float: right; padding-top: 1%">
      <button
        nz-button
        nzType="default"
        style="background-color: #9c9c9c; color: white"
        (click)="cancel()"
      >
        Hủy
      </button>
      <button
        nz-button
        nzType="primary"
        [disabled]="isDisable"
        (click)="save(modalContentContiniue)"
      >
        Gia hạn
      </button>
    </div>
  </div>
</nz-card>

<ng-template #modalContentContiniue>
  <nz-form-item> Quý khách chắc chắn muốn gia hạn dịch vụ này? </nz-form-item>
</ng-template>
